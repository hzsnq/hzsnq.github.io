import{a as S}from"./index-35b0e3a1.js";/* empty css                 *//* empty css                 *//* empty css                *//* empty css                  */import{i as Y,_ as he}from"./index-79b2cd3e.js";import{d as G,o as X,r as _,G as le,b,h as F,j as s,t as E,g as l,f as e,e as a,l as f,a1 as oe,F as L,i as se,c as z,K as O,E as ie,R as re,O as de,P as Ee,a2 as ce,a3 as ue,I as ye,_ as Z,an as Ae,ao as Ce,x as me,y as pe,a5 as ae,a6 as Ie,U as N,a7 as te,X as Pe,Y as Ve,a9 as Ue,aa as xe,k as Se,m as ke,W as De,ab as Re,a0 as $e,Z as Te}from"./index-5a0eb1b1.js";/* empty css                     */import{P as _e}from"./index-e099722b.js";import{i as Fe}from"./validate-add6ff74.js";/* empty css                             */import{u as qe}from"./AppMain.vue_vue_type_style_index_0_scoped_41d4e859_lang-bdfc2e53.js";import"./useUser-46e05e2c.js";const H=Symbol("admin"),Be={class:"pop-top"},Ne={class:"title"},ze={class:"form"},Le=G({__name:"CreateOrEditAdmin",setup(h){const{aId:v}=Y(H),{func:c}=Y(_e);X(()=>{I(),v.value&&k()});const y=_([]),g=_(),d=le({adminUserEmail:"",roleId:null,password:"asdf1234",password2:"asdf1234"}),o=le({adminUserEmail:[{required:!0,message:"Please input Email",trigger:"blur"},{validator:(r,t,n)=>{t===""?n(new Error("Please input Email")):Fe(t)?n():n(new Error("Email format is incorrect!"))},trigger:"blur"}],roleId:[{required:!0,message:"Please select Role",trigger:"change"}],password:[{required:!0,message:"Please input Password",trigger:"blur"},{min:8,max:16,message:"Length should be 8 to 16",trigger:"blur"}],password2:[{required:!0,message:"Please input Password",trigger:"blur"},{min:8,max:16,message:"Length should be 8 to 16",trigger:"blur"},{validator:(r,t,n)=>{t===""?n(new Error("Please input the Password again")):t!==d.password?n(new Error("Two inputs don't match!")):n()},trigger:"blur"}]}),A=async r=>{r&&await r.validate((t,n)=>{t?(console.log("submit!"),v.value?P():x()):(O.error("Please enter correct content!"),console.log("error submit!",n))})};async function I(){let r={};const[t,n]=await S.queryRoles(r);!t&&n&&(y.value=(n==null?void 0:n.data)||[])}async function x(){let r=d;const[t,n]=await S.createAdminUser(r);!t&&n&&n.success&&(O.success("Created successfully"),setTimeout(()=>{c()},1e3))}async function P(){let r={...d,id:v.value};const[t,n]=await S.editAdmin(r);!t&&n&&n.success&&(O.success("Edit successfully"),setTimeout(()=>{c()},1e3))}async function k(){var D,V;let r={id:v.value};const[t,n]=await S.queryAdminByIdWhenEdit(r);!t&&n&&(d.adminUserEmail=((D=n.data)==null?void 0:D.email)||"",d.roleId=Number((V=n.data)==null?void 0:V.roleId)||null)}return(r,t)=>{const n=ie,D=re,V=de,R=Ee,W=ce,j=ue,K=ye;return b(),F(L,null,[s("div",Be,[s("div",Ne,E(l(v)?"Edit Admin User":"Create Admin User"),1),s("div",null,[e(D,{type:"primary",color:"#4E9F1C",onClick:t[0]||(t[0]=w=>A(l(g)))},{default:a(()=>[f(E(l(v)?"Edit Admin User":"New Admin User")+" ",1),e(n,null,{default:a(()=>[e(l(oe))]),_:1})]),_:1})])]),s("div",ze,[e(K,{ref_key:"ruleFormRef",ref:g,model:l(d),rules:l(o),"label-width":"200px","status-icon":""},{default:a(()=>[e(R,{label:"Email",prop:"adminUserEmail"},{default:a(()=>[e(V,{modelValue:l(d).adminUserEmail,"onUpdate:modelValue":t[1]||(t[1]=w=>l(d).adminUserEmail=w)},null,8,["modelValue"])]),_:1}),e(R,{label:"Role",prop:"roleId"},{default:a(()=>[e(j,{modelValue:l(d).roleId,"onUpdate:modelValue":t[2]||(t[2]=w=>l(d).roleId=w),placeholder:"Select Role"},{default:a(()=>[(b(!0),F(L,null,se(l(y),(w,p)=>(b(),z(W,{label:w.roleName,value:w.id,key:p},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(R,{label:"Password",prop:"password"},{default:a(()=>[e(V,{modelValue:l(d).password,"onUpdate:modelValue":t[3]||(t[3]=w=>l(d).password=w),type:"password",placeholder:"Please input password","show-password":""},null,8,["modelValue"])]),_:1}),e(R,{label:"Password confirmation",prop:"password2"},{default:a(()=>[e(V,{modelValue:l(d).password2,"onUpdate:modelValue":t[4]||(t[4]=w=>l(d).password2=w),type:"password",placeholder:"Please input password","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])],64)}}});const ne=Z(Le,[["__scopeId","data-v-11c4a30d"]]),Me=h=>(me("data-v-914076a1"),h=h(),pe(),h),Oe=Me(()=>s("div",{class:"pop-top"},[s("div",{class:"title"},"View Admin User"),s("div")],-1)),We={class:"form"},je=G({__name:"ViewAdmin",setup(h){const{aId:v}=Y(H),c=_({});X(()=>{y()});async function y(){let g={id:v.value};const[d,u]=await S.queryAdminById(g);!d&&u&&(c.value=(u==null?void 0:u.data)||{})}return(g,d)=>{const u=Ae,q=Ce;return b(),F(L,null,[Oe,s("div",We,[e(q,{column:1,border:""},{default:a(()=>[e(u,{label:"Email","label-align":"center",align:"center"},{default:a(()=>{var o;return[f(E((o=l(c))==null?void 0:o.email),1)]}),_:1}),e(u,{label:"ID","label-align":"center",align:"center"},{default:a(()=>{var o;return[f(E((o=l(c))==null?void 0:o.id),1)]}),_:1}),e(u,{label:"Reset PWD Token","label-align":"center",align:"center"},{default:a(()=>{var o;return[f(E(((o=l(c))==null?void 0:o.resetPwdToken)||"EMPTY"),1)]}),_:1}),e(u,{label:"Reset PWD Send at","label-align":"center",align:"center"},{default:a(()=>{var o;return[f(E(((o=l(c))==null?void 0:o.resetPwdSendAt)||"EMPTY"),1)]}),_:1}),e(u,{label:"Create at","label-align":"center",align:"center"},{default:a(()=>{var o;return[f(E((o=l(c))==null?void 0:o.createAt),1)]}),_:1}),e(u,{label:"Update at","label-align":"center",align:"center"},{default:a(()=>{var o;return[f(E((o=l(c))==null?void 0:o.updateAt),1)]}),_:1}),e(u,{label:"Role","label-align":"center",align:"center"},{default:a(()=>{var o;return[f(E((o=l(c))==null?void 0:o.role),1)]}),_:1})]),_:1})])],64)}}});const Ke=Z(je,[["__scopeId","data-v-914076a1"]]),J=h=>(me("data-v-93228cba"),h=h(),pe(),h),Ye={class:"admin"},Ge=J(()=>s("div",{class:"title"},"Admin List",-1)),Xe={class:"tool-box"},Ze={class:"flex"},He={class:"table"},Je={class:"table-name"},Qe={class:"pointer"},el={class:"action"},ll=["onClick"],al=["onClick"],tl=J(()=>s("span",null,"Are you sure to delete this?",-1)),nl={class:"dialog-footer"},ol={class:"pagination"},sl=J(()=>s("div",null,null,-1)),il=G({__name:"index",setup(h){const{setBreadcrumbList:v}=qe(),c=_(),y=[{name:"add",component:ne},{name:"view",component:Ke},{name:"edit",component:ne}],g=_(null),d=[{value:0,label:"Contains"},{value:1,label:"Equals"},{value:2,label:"Starts with"},{value:3,label:"Ends with"}],u=_([]),q=_(0),o=_(10),A=_(1),I=_(null),x=_(""),P=_(!1),k=_(null);X(()=>{r()});async function r(){var M,U;g.value=null;let p={pageSize:o.value,pageNum:A.value},i={filterType:I.value,adminUserEmail:x.value};const[$,C]=await S.queryAdminUsers(i,p);!$&&C?(console.log(C.data),q.value=((M=C.data)==null?void 0:M.total)||0,u.value=((U=C.data)==null?void 0:U.list)||[]):console.log($)}const t=()=>{v([{name:"Create Admin User"}]),g.value=y.findIndex(p=>p.name==="add"),k.value=null,c.value.handleIsShow()},n=p=>{v([{name:"Edit Admin User"}]),g.value=y.findIndex(i=>i.name==="edit"),k.value=p.id,c.value.handleIsShow()},D=p=>{v([{name:"View Admin User"}]),g.value=y.findIndex(i=>i.name==="view"),k.value=p.id,c.value.handleIsShow()},V=()=>{P.value=!0},R=async p=>{const i={id:p.id},[$,C]=await S.delAdmin(i);!$&&C&&(C.data&&O.success("delete success"),P.value=!1,r())},W=()=>{console.log(I.value),A.value=1,r()},j=p=>{A.value=p,r()},K=()=>{I.value=null,x.value="",A.value=1,r()};return ae(_e,{func:()=>{c.value&&c.value.handleIsShow()}}),ae(H,{aId:k}),(p,i)=>{const $=ce,C=ue,M=de,U=re,Q=ie,B=De,fe=Re,ve=$e,ge=Pe,we=Te,be=Ve,ee=Ie("permission");return b(),F(L,null,[s("div",Ye,[Ge,s("div",Xe,[s("div",Ze,[e(C,{class:"select",modelValue:l(I),"onUpdate:modelValue":i[0]||(i[0]=m=>N(I)?I.value=m:null),clearable:"",placeholder:"Filter by"},{default:a(()=>[(b(),F(L,null,se(d,m=>e($,{key:m.value,label:m.label,value:m.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),e(M,{modelValue:l(x),"onUpdate:modelValue":i[1]||(i[1]=m=>N(x)?x.value=m:null),class:"m-lr-20",placeholder:"Search","prefix-icon":l(Ue),clearable:""},null,8,["modelValue","prefix-icon"]),e(U,{class:"text-white",type:"primary",color:"#BE9670",onClick:W},{default:a(()=>[f(" Search ")]),_:1}),e(U,{class:"text-828282",type:"primary",color:"#E8E8E8",onClick:K},{default:a(()=>[f(" Clear ")]),_:1})]),s("div",null,[te((b(),z(U,{type:"primary",color:"#4E9F1C",onClick:t},{default:a(()=>[f(" New Admin User "),e(Q,null,{default:a(()=>[e(l(oe))]),_:1})]),_:1})),[[ee,"Admin"]])])]),s("div",He,[l(u).length>0?(b(),z(ge,{key:0,data:l(u),height:"600","row-style":{height:"80px"}},{default:a(()=>[e(B,{prop:"id",label:"Admin ID",align:"center"},{default:a(m=>[s("div",Je,[s("span",null,E(m.row.id),1)])]),_:1}),e(B,{prop:"email",label:"Email",align:"left"}),e(B,{prop:"createAt",label:"Create at",align:"left"}),e(B,{prop:"role",label:"Role"}),e(B,{prop:"",label:"Action",align:"center"},{default:a(m=>[s("div",Qe,[e(ve,{placement:"bottom",width:170,trigger:"hover"},{reference:a(()=>[e(Q,{size:30,color:"#969696"},{default:a(()=>[e(l(xe))]),_:1})]),default:a(()=>[te((b(),F("div",el,[s("div",{class:"item",onClick:T=>D(m.row)},"View",8,ll),s("div",{class:"item",onClick:T=>n(m.row)},"Edit",8,al),s("div",{class:"item",onClick:i[2]||(i[2]=T=>V())},"Delete"),e(fe,{modelValue:l(P),"onUpdate:modelValue":i[4]||(i[4]=T=>N(P)?P.value=T:null),title:"Message",width:"30%","align-center":""},{footer:a(()=>[s("span",nl,[e(U,{onClick:i[3]||(i[3]=T=>P.value=!1)},{default:a(()=>[f("Cancel")]),_:1}),e(U,{type:"primary",onClick:T=>R(m.row)},{default:a(()=>[f(" Confirm ")]),_:2},1032,["onClick"])])]),default:a(()=>[tl]),_:2},1032,["modelValue"])])),[[ee,"Admin"]])]),_:2},1024)])]),_:1})]),_:1},8,["data"])):(b(),z(we,{key:1,"image-size":200}))]),s("div",ol,[sl,e(be,{background:"",layout:"total,consists of sizes, prev, pager, next, jumper, ->, slot",total:l(q),"page-size":l(o),"onUpdate:pageSize":i[5]||(i[5]=m=>N(o)?o.value=m:null),"current-page":l(A),"onUpdate:currentPage":i[6]||(i[6]=m=>N(A)?A.value=m:null),onCurrentChange:j},null,8,["total","page-size","current-page"])])]),e(l(he),{ref_key:"rightPanel",ref:c,onBackFn:r},{content:a(()=>[l(g)!==null?(b(),z(Se(y[l(g)].component),{key:0})):ke("",!0)]),_:1},512)],64)}}});const El=Z(il,[["__scopeId","data-v-93228cba"]]);export{El as default};
