import{a as U}from"./index-06066bd7.js";/* empty css                   *//* empty css                 *//* empty css                 *//* empty css                   *//* empty css                  */import{i as K,_ as be}from"./index-68a634a2.js";import{d as Q,o as W,r as f,D as ee,b as p,g as N,i as a,t as g,f as e,e as t,w as l,k as h,a0 as ae,c as T,F as z,h as oe,l as ne,J as H,E as ie,Q as se,a3 as we,a1 as ce,a2 as re,O as Ce,N as de,H as Ne,_ as X,R as J,al as Ae,am as Ve,v as ue,x as _e,a4 as te,a5 as xe,T as F,W as Ee,X as Ie,a6 as ke,a7 as Se,a8 as De,j as $e,V as Pe,a9 as Ye,$ as Me,Y as Fe}from"./index-1ae8a691.js";import{u as Te}from"./AppMain.vue_vue_type_style_index_0_scoped_41d4e859_lang-da327601.js";/* empty css                     *//* empty css                  */import{P as pe}from"./index-e099722b.js";/* empty css                             */import"./useUser-15c0fb72.js";const G=Symbol("notification"),Ue={class:"pop-top"},ze={class:"title"},Be={class:"form"},je={class:"flex-select"},Le=Q({__name:"CreateOrEditNotification",setup(y){const{nId:A}=K(G),{func:u}=K(pe);W(()=>{o(),A.value});const b=f([]),V=f(),n=ee({isAll:!1,clientIdArr:[],clientNameArr:[],title:"",message:""}),_=ee({isAll:[{required:!0,message:"Please select client",trigger:"change"}],title:[{required:!0,message:"Please input title",trigger:"blur"}],message:[{required:!0,message:"Please input message",trigger:"blur"}]}),w=async d=>{d&&await d.validate((i,s)=>{i?(console.log("submit!"),A.value||E()):(H.error("Please enter correct content!"),console.log("error submit!",s))})};async function o(){let d={};const[i,s]=await U.getClientsNames(d);!i&&s&&(b.value=(s==null?void 0:s.data)||[])}async function E(){let d=n;console.log(d);const[i,s]=await U.createNotification(d);!i&&s&&s.success&&(H.success("Created successfully"),setTimeout(()=>{u()},1e3))}const k=()=>{n.isAll&&(n.clientNameArr=[],n.clientIdArr=[])},S=d=>{let i=[];for(let s=0;s<b.value.length;s++)for(let v=0;v<d.length;v++)b.value[s].id===d[v]&&i.push(b.value[s].name);n.clientNameArr=i};return(d,i)=>{const s=ie,v=se,L=we,q=ce,R=re,P=Ce,B=de,O=Ne;return p(),N(z,null,[a("div",Ue,[a("div",ze,g(e(A)?"Edit notification":"Create notification"),1),a("div",null,[t(v,{type:"primary",color:"#4E9F1C",onClick:i[0]||(i[0]=m=>w(e(V)))},{default:l(()=>[h(g(e(A)?"Edit notification":"New notification")+" ",1),t(s,null,{default:l(()=>[t(e(ae))]),_:1})]),_:1})])]),a("div",Be,[t(O,{ref_key:"ruleFormRef",ref:V,model:e(n),rules:e(_),"label-width":"200px","status-icon":""},{default:l(()=>[t(P,{label:"Client",prop:"isAll"},{default:l(()=>[a("div",je,[t(L,{modelValue:e(n).isAll,"onUpdate:modelValue":i[1]||(i[1]=m=>e(n).isAll=m),"active-text":"All","inactive-text":"No",onChange:k},null,8,["modelValue"]),e(n).isAll?ne("",!0):(p(),T(R,{key:0,modelValue:e(n).clientIdArr,"onUpdate:modelValue":i[2]||(i[2]=m=>e(n).clientIdArr=m),multiple:"",placeholder:"Select",filterable:"",style:{width:"500px"},onChange:S},{default:l(()=>[(p(!0),N(z,null,oe(e(b),m=>(p(),T(q,{key:m.id,label:m.name,value:m.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]))])]),_:1}),t(P,{label:"Title",prop:"title"},{default:l(()=>[t(B,{modelValue:e(n).title,"onUpdate:modelValue":i[3]||(i[3]=m=>e(n).title=m)},null,8,["modelValue"])]),_:1}),t(P,{label:"Message",prop:"message"},{default:l(()=>[t(B,{modelValue:e(n).message,"onUpdate:modelValue":i[4]||(i[4]=m=>e(n).message=m),type:"textarea",autosize:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])],64)}}});const le=X(Le,[["__scopeId","data-v-3311a6c7"]]),qe=y=>(ue("data-v-12d17844"),y=y(),_e(),y),Re=qe(()=>a("div",{class:"pop-top"},[a("div",{class:"title"},"View notification"),a("div")],-1)),Oe={class:"form"},Ke={key:0},He={key:1},Je=Q({__name:"ViewNotification",setup(y){const{nId:A}=K(G),u=f({});W(()=>{b()});async function b(){let V={id:A.value};const[n,_]=await U.queryNotificationById(V);!n&&_&&(console.log(_.data),u.value=(_==null?void 0:_.data)||{})}return(V,n)=>{const _=Ae,w=Ve;return p(),N(z,null,[Re,a("div",Oe,[t(w,{column:1,border:""},{default:l(()=>[t(_,{label:"ID","label-align":"center",align:"center"},{default:l(()=>{var o;return[h(g((o=e(u))==null?void 0:o.id),1)]}),_:1}),t(_,{label:"Title","label-align":"center",align:"center"},{default:l(()=>{var o;return[h(g((o=e(u))==null?void 0:o.title),1)]}),_:1}),t(_,{label:"Message","label-align":"center",align:"center"},{default:l(()=>{var o;return[h(g(((o=e(u))==null?void 0:o.message)||"EMPTY"),1)]}),_:1}),t(_,{label:"Client","label-align":"center",align:"center"},{default:l(()=>{var o,E,k;return[(o=e(u))!=null&&o.isAll?(p(),N("div",Ke,"All")):(p(),N("div",He,g((E=e(u))!=null&&E.clientNameArr?(k=e(u))==null?void 0:k.clientNameArr.join(","):""),1))]}),_:1}),t(_,{label:"Created At","label-align":"center",align:"center"},{default:l(()=>{var o;return[h(g(e(J)((o=e(u))==null?void 0:o.createdAt).format("DD.MM.YYYY")),1)]}),_:1}),t(_,{label:"Updated At","label-align":"center",align:"center"},{default:l(()=>{var o;return[h(g(e(J)((o=e(u))==null?void 0:o.updatedAt).format("DD.MM.YYYY")),1)]}),_:1})]),_:1})])],64)}}});const Qe=X(Je,[["__scopeId","data-v-12d17844"]]),Z=y=>(ue("data-v-47380328"),y=y(),_e(),y),We={class:"Notification"},Xe=Z(()=>a("div",{class:"title"},"Notification List",-1)),Ge={class:"tool-box"},Ze={class:"flex"},et={class:"table"},tt={class:"table-name"},lt={class:"table-cut"},at={key:0},ot={key:1},nt={class:"pointer"},it={class:"action"},st=["onClick"],ct=Z(()=>a("span",null,"Are you sure to delete this?",-1)),rt={class:"dialog-footer"},dt={class:"pagination"},ut=Z(()=>a("div",null,null,-1)),_t=Q({__name:"index",setup(y){const{setBreadcrumbList:A}=Te(),u=f(),b=f(!0),V=[{name:"view",component:Qe},{name:"add",component:le},{name:"edit",component:le}],n=f(null),_=[{value:0,label:"Client",name:"clientId"}],w=f(null),o=f(""),E=f([]),k=f(0),S=f(10),d=f(1),i=f(null),s=f(!1);W(()=>{v()});async function v(){var j,I,Y;n.value=null;let C={pageSize:S.value,pageNum:d.value},r={};w.value!==null&&(r={[_[w.value].name]:o.value});const[D,x]=await U.queryNotificationPage(r,C);b.value=!1,!D&&x?(console.log((j=x.data)==null?void 0:j.list),k.value=((I=x.data)==null?void 0:I.total)||0,E.value=((Y=x.data)==null?void 0:Y.list)||[]):console.log(D)}const L=C=>{d.value=C,v()},q=()=>{w.value=null,o.value="",d.value=1,v()},R=()=>{d.value=1,v()},P=()=>{A([{name:"Create Notification"}]),n.value=V.findIndex(C=>C.name==="add"),i.value=null,u.value.handleIsShow()},B=C=>{A([{name:"View Notification"}]),n.value=V.findIndex(r=>r.name==="view"),i.value=C.id,u.value.handleIsShow()},O=()=>{s.value=!0},m=async C=>{const r={id:C.id},[D,x]=await U.delNotification(r);!D&&x&&(x.data&&H.success("delete success"),s.value=!1,v())};return te(pe,{func:()=>{u.value&&u.value.handleIsShow()}}),te(G,{nId:i}),(C,r)=>{const D=ce,x=re,j=de,I=se,Y=ie,$=Pe,me=Ye,fe=Me,ve=Ee,ge=Fe,he=Ie,ye=ke;return p(),N(z,null,[xe((p(),N("div",We,[Xe,a("div",Ge,[a("div",Ze,[t(x,{class:"select",modelValue:e(w),"onUpdate:modelValue":r[0]||(r[0]=c=>F(w)?w.value=c:null),clearable:"",placeholder:"Filter by"},{default:l(()=>[(p(),N(z,null,oe(_,c=>t(D,{key:c.value,label:c.label,value:c.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),t(j,{modelValue:e(o),"onUpdate:modelValue":r[1]||(r[1]=c=>F(o)?o.value=c:null),class:"m-lr-20",placeholder:"Search","prefix-icon":e(Se),clearable:""},null,8,["modelValue","prefix-icon"]),t(I,{class:"text-white",type:"primary",color:"#BE9670",onClick:R},{default:l(()=>[h(" Search ")]),_:1}),t(I,{class:"text-828282",type:"primary",color:"#E8E8E8",onClick:q},{default:l(()=>[h(" Clear ")]),_:1})]),a("div",null,[t(I,{type:"primary",color:"#4E9F1C",onClick:P},{default:l(()=>[h(" New Notification "),t(Y,null,{default:l(()=>[t(e(ae))]),_:1})]),_:1})])]),a("div",et,[e(E).length>0?(p(),T(ve,{key:0,data:e(E),height:"600","row-style":{height:"80px"}},{default:l(()=>[t($,{prop:"id",label:"Notification ID",align:"center",width:"130"},{default:l(c=>[a("div",tt,[a("span",null,g(c.row.id),1)])]),_:1}),t($,{prop:"title",label:"Title",align:"center",width:"200"}),t($,{prop:"message",label:"Message",align:"center",width:"300"},{default:l(c=>[a("div",lt,g(c.row.message),1)]),_:1}),t($,{prop:"createdAt",label:"Create at",width:"200"},{default:l(c=>[a("span",null,g(e(J)(c.row.createdAt).format("DD.MM.YYYY")),1)]),_:1}),t($,{prop:"clientNameArr",label:"Client",width:"200"},{default:l(c=>[c.row.isAll?(p(),N("div",at,"All")):(p(),N("div",ot,g(c.row.clientNameArr.join(",")),1))]),_:1}),t($,{prop:"",label:"Action",align:"center",fixed:"right"},{default:l(c=>[a("div",nt,[t(fe,{placement:"bottom",width:170,trigger:"hover"},{reference:l(()=>[t(Y,{size:30,color:"#969696"},{default:l(()=>[t(e(De))]),_:1})]),default:l(()=>[a("div",it,[a("div",{class:"item",onClick:M=>B(c.row)},"View",8,st),a("div",{class:"item",onClick:r[2]||(r[2]=M=>O())},"Delete"),t(me,{modelValue:e(s),"onUpdate:modelValue":r[4]||(r[4]=M=>F(s)?s.value=M:null),title:"Message",width:"30%","align-center":""},{footer:l(()=>[a("span",rt,[t(I,{onClick:r[3]||(r[3]=M=>s.value=!1)},{default:l(()=>[h("Cancel")]),_:1}),t(I,{type:"primary",onClick:M=>m(c.row)},{default:l(()=>[h(" Confirm ")]),_:2},1032,["onClick"])])]),default:l(()=>[ct]),_:2},1032,["modelValue"])])]),_:2},1024)])]),_:1})]),_:1},8,["data"])):(p(),T(ge,{key:1,"image-size":200}))]),a("div",dt,[ut,t(he,{background:"",layout:"total,consists of sizes, prev, pager, next, jumper, ->, slot",total:e(k),"page-size":e(S),"onUpdate:pageSize":r[5]||(r[5]=c=>F(S)?S.value=c:null),"current-page":e(d),"onUpdate:currentPage":r[6]||(r[6]=c=>F(d)?d.value=c:null),onCurrentChange:L},null,8,["total","page-size","current-page"])])])),[[ye,e(b)]]),t(e(be),{ref_key:"rightPanel",ref:u,onBackFn:v},{content:l(()=>[e(n)!==null?(p(),T($e(V[e(n)].component),{key:0})):ne("",!0)]),_:1},512)],64)}}});const It=X(_t,[["__scopeId","data-v-47380328"]]);export{It as default};
