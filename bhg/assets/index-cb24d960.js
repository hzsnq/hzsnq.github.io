import{a as O}from"./index-06066bd7.js";/* empty css                   *//* empty css                 *//* empty css                 *//* empty css                   */import{d as K,r as d,o as Q,b as c,g as h,i,F as x,h as R,t as B,f as t,e as a,w as o,k as E,c as k,l as F,J as pe,al as _e,am as me,Q as W,v as X,x as G,_ as Z,a4 as J,a5 as ve,T,a2 as fe,N as ge,W as ye,X as he,a6 as be,a7 as Ce,R as we,a8 as Ee,j as ke,a1 as Se,V as xe,E as Ve,$ as Ae,Y as Ie}from"./index-1ae8a691.js";import{u as ee}from"./AppMain.vue_vue_type_style_index_0_scoped_41d4e859_lang-da327601.js";import{i as H,_ as $e}from"./index-68a634a2.js";/* empty css                             */import{P as te}from"./index-e099722b.js";import"./useUser-15c0fb72.js";const le=Symbol("audit"),De=v=>(X("data-v-2c8434d7"),v=v(),G(),v),Te={class:"pop-top"},Be={class:"title"},Ne=De(()=>i("div",null,null,-1)),Pe={class:"form"},Re={class:"block padding-b-20"},je={class:"block padding-t-20 padding-b-20"},ze={class:"btn-group"},Ue=K({__name:"ViewAudit",setup(v){const{breadcrumbList:z}=ee(),{aId:b}=H(le),{func:V}=H(te),m=d({});Q(()=>{A()});async function A(){var r,p,s,f;let I={id:b.value};const[u,l]=await O.queryAuditById(I);if(!u&&l){if(console.log(l.data),(r=l.data)!=null&&r.newEntity&&(l.data.newEntity=JSON.parse((p=l.data)==null?void 0:p.newEntity)),(s=l.data)!=null&&s.entityContent){l.data.entityContent=JSON.parse((f=l.data)==null?void 0:f.entityContent);let g=Object.entries(l.data.entityContent);const _=[];for(let C=0;C<g.length;C++){let y=Object.entries(g[C][1]),q={name:`current ${g[C][0]}`,value:y[0][0]},L={name:`new ${g[C][0]}`,value:y[0][1]};_.push(q),_.push(L)}console.log(_),l.data.entityContentShow=_}m.value=(l==null?void 0:l.data)||{}}}const N=async I=>{let u={id:b.value,status:I};const[l,r]=await O.editAudit(u);!l&&r&&(pe.success("Change successfully"),setTimeout(()=>{V()},1e3))},U=()=>{V()};return(I,u)=>{const l=_e,r=me,p=W;return c(),h(x,null,[i("div",Te,[i("div",Be,[(c(!0),h(x,null,R(t(z),(s,f)=>(c(),h("span",{key:f},B(s.name),1))),128)),i("span",null," - ID:"+B(t(b)),1)]),Ne]),i("div",Pe,[i("div",Re,[a(r,{title:"",column:1,border:""},{default:o(()=>[a(l,{label:"Account Email","label-align":"center",align:"center"},{default:o(()=>{var s;return[E(B((s=t(m))==null?void 0:s.creatorName),1)]}),_:1}),a(l,{label:"Client ID","label-align":"center",align:"center"},{default:o(()=>{var s;return[E(B((s=t(m))==null?void 0:s.name),1)]}),_:1})]),_:1})]),i("div",je,[a(r,{title:t(m).auditType,column:1,border:""},{default:o(()=>[(c(!0),h(x,null,R(t(m).entityContentShow,(s,f)=>(c(),k(l,{label:s.name,"label-align":"center",align:"center",key:f},{default:o(()=>[E(B(s.value),1)]),_:2},1032,["label"]))),128))]),_:1},8,["title"])]),i("div",ze,[t(m).status!=="Approved"?(c(),k(p,{key:0,color:"#4E9F1C",onClick:u[0]||(u[0]=s=>N("Approved"))},{default:o(()=>[E("Approve")]),_:1})):F("",!0),t(m).status!=="Approved"?(c(),k(p,{key:1,color:"#DC0000",onClick:u[1]||(u[1]=s=>N("Rejected"))},{default:o(()=>[E("Reject")]),_:1})):F("",!0),a(p,{class:"text-white",color:"#BDBDBD",onClick:U},{default:o(()=>[E("Cancel")]),_:1})])])],64)}}});const qe=Z(Ue,[["__scopeId","data-v-2c8434d7"]]),Y=v=>(X("data-v-e2474bf2"),v=v(),G(),v),Le={class:"audit"},Oe=Y(()=>i("div",{class:"title"},"Audit List",-1)),Fe={class:"tool-box"},Ye={class:"flex"},Me=Y(()=>i("div",null,null,-1)),Je={class:"table"},He={class:"pointer"},Ke={class:"action"},Qe=["onClick"],We={class:"pagination"},Xe=Y(()=>i("div",null,null,-1)),Ge=K({__name:"index",setup(v){const{setBreadcrumbList:z}=ee(),b=d(),V=d(!0),m=[{name:"view",component:qe}],A=d(null),N=[{value:0,label:"Email",name:"creatorName"}],U=d([{code:"Client Update"},{code:"Re-Investment request"},{code:"Entity Update"}]),I=d([{code:"Approved"},{code:"Rejected"},{code:"Pending approval"}]),u=d(null),l=d(null),r=d(null),p=d(""),s=d([]),f=d(0),g=d(10),_=d(1),C=d(null);Q(()=>{y()});async function y(){var j,P;A.value=null;let S={pageSize:g.value,pageNum:_.value},n={};u.value!==null&&(n={[N[u.value].name]:p.value}),r.value!==null&&(n={...n,status:r.value}),l.value!==null&&(n={...n,auditType:l.value}),V.value=!1;const[$,w]=await O.queryAudit(n,S);V.value=!1,!$&&w?(console.log(w.data.list),f.value=((j=w.data)==null?void 0:j.total)||0,s.value=((P=w.data)==null?void 0:P.list)||[]):console.log($)}const q=S=>{_.value=S,y()},L=()=>{u.value=null,p.value="",_.value=1,y()},ae=()=>{_.value=1,y()},ne=async S=>{z([{name:`${S.auditType} Request`}]),A.value=m.findIndex(n=>n.name==="view"),C.value=S.id,b.value.handleIsShow()},oe=()=>{b.value&&b.value.handleIsShow()},M=()=>{y()};return J(te,{func:oe}),J(le,{aId:C}),(S,n)=>{const $=Se,w=fe,j=ge,P=W,D=xe,se=Ve,ie=Ae,ce=ye,ue=Ie,de=he,re=be;return c(),h(x,null,[ve((c(),h("div",Le,[Oe,i("div",Fe,[i("div",Ye,[a(w,{class:"select",modelValue:t(u),"onUpdate:modelValue":n[0]||(n[0]=e=>T(u)?u.value=e:null),clearable:"",placeholder:"Filter by"},{default:o(()=>[(c(),h(x,null,R(N,e=>a($,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),a(j,{modelValue:t(p),"onUpdate:modelValue":n[1]||(n[1]=e=>T(p)?p.value=e:null),class:"m-lr-20 width-200",placeholder:"Search","prefix-icon":t(Ce),clearable:""},null,8,["modelValue","prefix-icon"]),a(P,{class:"text-white",type:"primary",color:"#BE9670",onClick:ae},{default:o(()=>[E(" Search ")]),_:1}),a(P,{class:"text-828282",type:"primary",color:"#E8E8E8",onClick:L},{default:o(()=>[E(" Clear ")]),_:1}),a(w,{class:"select m-l-20",modelValue:t(l),"onUpdate:modelValue":n[2]||(n[2]=e=>T(l)?l.value=e:null),clearable:"",placeholder:"Type",onChange:M},{default:o(()=>[(c(!0),h(x,null,R(t(U),e=>(c(),k($,{key:e.code,label:e.code,value:e.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),a(w,{class:"select m-l-20",modelValue:t(r),"onUpdate:modelValue":n[3]||(n[3]=e=>T(r)?r.value=e:null),clearable:"",placeholder:"Status",onChange:M},{default:o(()=>[(c(!0),h(x,null,R(t(I),e=>(c(),k($,{key:e.code,label:e.code,value:e.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),Me]),i("div",Je,[t(s).length>0?(c(),k(ce,{key:0,data:t(s),height:"600","row-style":{height:"80px"}},{default:o(()=>[a(D,{prop:"id",label:"Request ID",align:"center"}),a(D,{prop:"auditType",label:"Type",align:"left"}),a(D,{prop:"creatorName",label:"Email",align:"left"}),a(D,{prop:"status",label:"Status"}),a(D,{prop:"updatedAt",label:"Request Time"},{default:o(e=>[i("span",null,B(t(we)(e.row.updatedAt).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1}),a(D,{prop:"",label:"Action",align:"center"},{default:o(e=>[i("div",He,[a(ie,{placement:"bottom",width:170,trigger:"hover"},{reference:o(()=>[a(se,{size:30,color:"#969696"},{default:o(()=>[a(t(Ee))]),_:1})]),default:o(()=>[i("div",Ke,[i("div",{class:"item",onClick:Ze=>ne(e.row)},"View",8,Qe)])]),_:2},1024)])]),_:1})]),_:1},8,["data"])):(c(),k(ue,{key:1,"image-size":200}))]),i("div",We,[Xe,a(de,{background:"",layout:"total,consists of sizes, prev, pager, next, jumper, ->, slot",total:t(f),"page-size":t(g),"onUpdate:pageSize":n[4]||(n[4]=e=>T(g)?g.value=e:null),"current-page":t(_),"onUpdate:currentPage":n[5]||(n[5]=e=>T(_)?_.value=e:null),onCurrentChange:q},null,8,["total","page-size","current-page"])])])),[[re,t(V)]]),a(t($e),{ref_key:"rightPanel",ref:b,onBackFn:y},{content:o(()=>[t(A)!==null?(c(),k(ke(m[t(A)].component),{key:0})):F("",!0)]),_:1},512)],64)}}});const rt=Z(Ge,[["__scopeId","data-v-e2474bf2"]]);export{rt as default};
