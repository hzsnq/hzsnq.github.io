import{a as B}from"./index-62d2fc31.js";/* empty css                   *//* empty css                 *//* empty css                 *//* empty css                   *//* empty css                  */import{i as j,_ as ye}from"./index-c38978f2.js";import{d as H,o as J,r as f,D as Z,b,g as x,i as n,t as g,f as t,e,w as a,k as p,a0 as ae,c as D,F,h as ne,l as K,J as ee,E as oe,Q as ie,a3 as Ce,a1 as se,a2 as ce,O as we,N as re,H as Ee,_ as Q,ak as Ie,al as Ne,v as de,x as ue,a4 as te,a5 as Ve,T as $,W as xe,X as ke,a6 as Se,a7 as Ae,a8 as Pe,j as Te,V as $e,a9 as De,$ as Fe,Y as Me}from"./index-53be2c6b.js";import{u as Le}from"./AppMain.vue_vue_type_style_index_0_scoped_41d4e859_lang-05b22a52.js";/* empty css                     *//* empty css                  */import{P as _e}from"./index-e099722b.js";/* empty css                             */import"./useUser-a1bf5fc0.js";const W=Symbol("notification"),Ue={class:"pop-top"},ze={class:"title"},Be={class:"form"},Ye={class:"flex-select"},qe=H({__name:"CreateOrEditNotification",setup(C){const{nId:w}=j(W),{func:u}=j(_e);J(()=>{l(),w.value});const E=f([]),I=f(),o=Z({isAll:!1,clientIdArr:[],clientNameArr:[],title:"",message:""}),r=Z({isAll:[{required:!0,message:"Please select client",trigger:"change"}],title:[{required:!0,message:"Please input title",trigger:"blur"}],message:[{required:!0,message:"Please input message",trigger:"blur"}]}),N=async _=>{_&&await _.validate((i,s)=>{i?(console.log("submit!"),w.value||P()):(ee.error("Please enter correct content!"),console.log("error submit!",s))})};async function l(){let _={};const[i,s]=await B.getClientsNames(_);!i&&s&&(E.value=(s==null?void 0:s.data)||[])}async function P(){let _=o;console.log(_);const[i,s]=await B.createNotification(_);!i&&s&&s.success&&(ee.success("Created successfully"),setTimeout(()=>{u()},1e3))}const M=()=>{o.isAll&&(o.clientNameArr=[],o.clientIdArr=[])},k=_=>{let i=[];for(let s=0;s<E.value.length;s++)for(let h=0;h<_.length;h++)E.value[s].id===_[h]&&i.push(E.value[s].name);o.clientNameArr=i};return(_,i)=>{const s=oe,h=ie,Y=Ce,q=se,O=ce,T=we,L=re,R=Ee;return b(),x(F,null,[n("div",Ue,[n("div",ze,g(t(w)?"Edit notification":"Create notification"),1),n("div",null,[e(h,{type:"primary",color:"#4E9F1C",onClick:i[0]||(i[0]=m=>N(t(I)))},{default:a(()=>[p(g(t(w)?"Edit notification":"New notification")+" ",1),e(s,null,{default:a(()=>[e(t(ae))]),_:1})]),_:1})])]),n("div",Be,[e(R,{ref_key:"ruleFormRef",ref:I,model:t(o),rules:t(r),"label-width":"200px","status-icon":""},{default:a(()=>[e(T,{label:"Client",prop:"isAll"},{default:a(()=>[n("div",Ye,[e(Y,{modelValue:t(o).isAll,"onUpdate:modelValue":i[1]||(i[1]=m=>t(o).isAll=m),"active-text":"All","inactive-text":"No",onChange:M},null,8,["modelValue"]),t(o).isAll?K("",!0):(b(),D(O,{key:0,modelValue:t(o).clientIdArr,"onUpdate:modelValue":i[2]||(i[2]=m=>t(o).clientIdArr=m),multiple:"",placeholder:"Select",filterable:"",style:{width:"500px"},onChange:k},{default:a(()=>[(b(!0),x(F,null,ne(t(E),m=>(b(),D(q,{key:m.id,label:m.name,value:m.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]))])]),_:1}),e(T,{label:"Title",prop:"title"},{default:a(()=>[e(L,{modelValue:t(o).title,"onUpdate:modelValue":i[3]||(i[3]=m=>t(o).title=m)},null,8,["modelValue"])]),_:1}),e(T,{label:"Message",prop:"message"},{default:a(()=>[e(L,{modelValue:t(o).message,"onUpdate:modelValue":i[4]||(i[4]=m=>t(o).message=m),type:"textarea",autosize:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])],64)}}});const le=Q(qe,[["__scopeId","data-v-4df2c014"]]),Oe=C=>(de("data-v-a56bf5f1"),C=C(),ue(),C),Re=Oe(()=>n("div",{class:"pop-top"},[n("div",{class:"title"},"View notification"),n("div")],-1)),je={class:"form"},Ke=H({__name:"ViewNotification",setup(C){const{nId:w}=j(W),u=f({});J(()=>{E()});async function E(){let I={id:w.value};const[o,r]=await B.queryEventById(I);!o&&r&&(console.log(r.data),u.value=(r==null?void 0:r.data)||{})}return(I,o)=>{const r=Ie,N=Ne;return b(),x(F,null,[Re,n("div",je,[e(N,{column:1,border:""},{default:a(()=>[e(r,{label:"ID","label-align":"center",align:"center"},{default:a(()=>{var l;return[p(g((l=t(u))==null?void 0:l.id),1)]}),_:1}),e(r,{label:"Name","label-align":"center",align:"center"},{default:a(()=>{var l;return[p(g((l=t(u))==null?void 0:l.name),1)]}),_:1}),e(r,{label:"Message","label-align":"center",align:"center"},{default:a(()=>{var l;return[p(g(((l=t(u))==null?void 0:l.message)||"EMPTY"),1)]}),_:1}),e(r,{label:"Email","label-align":"center",align:"center"},{default:a(()=>{var l;return[p(g((l=t(u))==null?void 0:l.email),1)]}),_:1}),e(r,{label:"Create at","label-align":"center",align:"center"},{default:a(()=>{var l;return[p(g((l=t(u))==null?void 0:l.createAt),1)]}),_:1}),e(r,{label:"Update At","label-align":"center",align:"center"},{default:a(()=>{var l;return[p(g(((l=t(u))==null?void 0:l.updateAt)||"EMPTY"),1)]}),_:1}),e(r,{label:"Phone","label-align":"center",align:"center"},{default:a(()=>{var l;return[p(g(((l=t(u))==null?void 0:l.phone)||"EMPTY"),1)]}),_:1}),e(r,{label:"Interest","label-align":"center",align:"center"},{default:a(()=>{var l;return[p(g(((l=t(u))==null?void 0:l.interest)||"EMPTY"),1)]}),_:1}),e(r,{label:"Suburb","label-align":"center",align:"center"},{default:a(()=>{var l;return[p(g(((l=t(u))==null?void 0:l.suburb)||"EMPTY"),1)]}),_:1}),e(r,{label:"State","label-align":"center",align:"center"},{default:a(()=>{var l;return[p(g(((l=t(u))==null?void 0:l.state)||"EMPTY"),1)]}),_:1})]),_:1})])],64)}}});const He=Q(Ke,[["__scopeId","data-v-a56bf5f1"]]),X=C=>(de("data-v-e8fade0c"),C=C(),ue(),C),Je={class:"Notification"},Qe=X(()=>n("div",{class:"title"},"Notification List",-1)),We={class:"tool-box"},Xe={class:"flex"},Ge={class:"table"},Ze={class:"table-name"},et={class:"table-cut"},tt={class:"table-img"},lt=["src"],at={class:"pointer"},nt={class:"action"},ot=["onClick"],it=["onClick"],st=X(()=>n("span",null,"Are you sure to delete this?",-1)),ct={class:"dialog-footer"},rt={class:"pagination"},dt=X(()=>n("div",null,null,-1)),ut=H({__name:"index",setup(C){const{setBreadcrumbList:w}=Le(),u=f(),E=f(!0),I=[{name:"view",component:He},{name:"add",component:le},{name:"edit",component:le}],o=f(null),r=[{value:0,label:"Client",name:"clientId"}],N=f(null),l=f(""),P=f([]),M=f(0),k=f(10),_=f(1),i=f(null),s=f(!1);J(()=>{h()});async function h(){var z,V;o.value=null;let v={pageSize:k.value,pageNum:_.value},d={};N.value!==null&&(d={[r[N.value].name]:l.value});const[U,S]=await B.queryNotificationPage(d,v);E.value=!1,!U&&S?(console.log(S.data),M.value=((z=S.data)==null?void 0:z.total)||0,P.value=((V=S.data)==null?void 0:V.list)||[]):console.log(U)}const Y=v=>{_.value=v,h()},q=()=>{N.value=null,l.value="",_.value=1,h()},O=()=>{_.value=1,h()},T=()=>{w([{name:"Create Notification"}]),o.value=I.findIndex(v=>v.name==="add"),i.value=null,u.value.handleIsShow()},L=v=>{w([{name:"View Notification"}]),o.value=I.findIndex(d=>d.name==="view"),i.value=v.id,u.value.handleIsShow()},R=v=>{w([{name:"Edit Notification"}]),o.value=I.findIndex(d=>d.name==="edit"),i.value=v.id,u.value.handleIsShow()},m=()=>{s.value=!0},pe=async v=>{v.id};return te(_e,{func:()=>{u.value&&u.value.handleIsShow()}}),te(W,{nId:i}),(v,d)=>{const U=se,S=ce,z=re,V=ie,G=oe,y=$e,me=De,fe=Fe,ge=xe,ve=Me,be=ke,he=Se;return b(),x(F,null,[Ve((b(),x("div",Je,[Qe,n("div",We,[n("div",Xe,[e(S,{class:"select",modelValue:t(N),"onUpdate:modelValue":d[0]||(d[0]=c=>$(N)?N.value=c:null),clearable:"",placeholder:"Filter by"},{default:a(()=>[(b(),x(F,null,ne(r,c=>e(U,{key:c.value,label:c.label,value:c.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),e(z,{modelValue:t(l),"onUpdate:modelValue":d[1]||(d[1]=c=>$(l)?l.value=c:null),class:"m-lr-20",placeholder:"Search","prefix-icon":t(Ae),clearable:""},null,8,["modelValue","prefix-icon"]),e(V,{class:"text-white",type:"primary",color:"#BE9670",onClick:O},{default:a(()=>[p(" Search ")]),_:1}),e(V,{class:"text-828282",type:"primary",color:"#E8E8E8",onClick:q},{default:a(()=>[p(" Clear ")]),_:1})]),n("div",null,[e(V,{type:"primary",color:"#4E9F1C",onClick:T},{default:a(()=>[p(" New Notification "),e(G,null,{default:a(()=>[e(t(ae))]),_:1})]),_:1})])]),n("div",Ge,[t(P).length>0?(b(),D(ge,{key:0,data:t(P),height:"600","row-style":{height:"80px"}},{default:a(()=>[e(y,{prop:"id",label:"Notification ID",align:"center"},{default:a(c=>[n("div",Ze,[n("span",null,g(c.row.id),1)])]),_:1}),e(y,{prop:"title",label:"Title",align:"left"}),e(y,{prop:"startTime",label:"Start Time",align:"left"}),e(y,{prop:"location",label:"Location"}),e(y,{prop:"briefIntroduction",label:"Introduction"},{default:a(c=>[n("div",et,g(c.row.briefIntroduction),1)]),_:1}),e(y,{prop:"language",label:"Language"}),e(y,{prop:"mainImg",label:"Image"},{default:a(c=>[n("div",tt,[c.row.mainImg?(b(),x("img",{key:0,class:"img-bg",src:c.row.mainImg},null,8,lt)):K("",!0)])]),_:1}),e(y,{prop:"link",label:"Link"}),e(y,{prop:"file",label:"File"}),e(y,{prop:"status",label:"Status"}),e(y,{prop:"",label:"Action",align:"center"},{default:a(c=>[n("div",at,[e(fe,{placement:"bottom",width:170,trigger:"hover"},{reference:a(()=>[e(G,{size:30,color:"#969696"},{default:a(()=>[e(t(Pe))]),_:1})]),default:a(()=>[n("div",nt,[n("div",{class:"item",onClick:A=>L(c.row)},"View",8,ot),n("div",{class:"item",onClick:A=>R(c.row)},"Edit",8,it),n("div",{class:"item",onClick:d[2]||(d[2]=A=>m())},"Delete"),e(me,{modelValue:t(s),"onUpdate:modelValue":d[4]||(d[4]=A=>$(s)?s.value=A:null),title:"Message",width:"30%","align-center":""},{footer:a(()=>[n("span",ct,[e(V,{onClick:d[3]||(d[3]=A=>s.value=!1)},{default:a(()=>[p("Cancel")]),_:1}),e(V,{type:"primary",onClick:A=>pe(c.row)},{default:a(()=>[p(" Confirm ")]),_:2},1032,["onClick"])])]),default:a(()=>[st]),_:2},1032,["modelValue"])])]),_:2},1024)])]),_:1})]),_:1},8,["data"])):(b(),D(ve,{key:1,"image-size":200}))]),n("div",rt,[dt,e(be,{background:"",layout:"total,consists of sizes, prev, pager, next, jumper, ->, slot",total:t(M),"page-size":t(k),"onUpdate:pageSize":d[5]||(d[5]=c=>$(k)?k.value=c:null),"current-page":t(_),"onUpdate:currentPage":d[6]||(d[6]=c=>$(_)?_.value=c:null),onCurrentChange:Y},null,8,["total","page-size","current-page"])])])),[[he,t(E)]]),e(t(ye),{ref_key:"rightPanel",ref:u,onBackFn:h},{content:a(()=>[t(o)!==null?(b(),D(Te(I[t(o)].component),{key:0})):K("",!0)]),_:1},512)],64)}}});const xt=Q(ut,[["__scopeId","data-v-e8fade0c"]]);export{xt as default};
