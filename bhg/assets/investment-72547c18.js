import{a as V}from"./index-35b0e3a1.js";/* empty css                     *//* empty css                    *//* empty css                 *//* empty css                *//* empty css                 */import{d as z,r as L,G as P,o as H,b as p,h as c,j as g,t as U,g as a,f as l,e as o,l as S,a1 as M,F as I,i as k,c as $,aq as J,ar as Q,U as W,K as C,E as X,R as Y,O as Z,P as ee,a2 as te,a3 as le,ad as ae,I as se,_ as ie}from"./index-5a0eb1b1.js";import{i as N}from"./index-79b2cd3e.js";import{P as oe}from"./index-e099722b.js";import{E as ne}from"./CreatePurchase.vue_vue_type_style_index_0_scoped_0b5a1580_lang-dd48f447.js";const re={class:"pop-top"},ue={class:"title"},de={class:"form"},me={class:"email-list"},pe={key:0,class:"flex"},ce={key:1,class:"flex"},ye=z({__name:"CreateOrEditEntity",setup(fe){const{eId:y,clientInfo:v,entityInfo:u}=N(ne),{func:T}=N(oe),E=L([]),f=L([]),F=L(),e=P({addressLine:"",bhgId:"",emailList:[],entityName:"",suburb:"",state:"",postcode:"",applicationFormSigned:"",entityType:""}),q=P({entityName:[{required:!0,message:"Please input Entity Name",trigger:"blur"}],bhgId:[{required:!0,message:"Please input BHG ID",trigger:"blur"}],suburb:[{required:!0,message:"Please input Suburb",trigger:"blur"}],addressLine:[{required:!0,message:"Please input Address line",trigger:"blur"}],state:[{required:!0,message:"Please input State",trigger:"blur"}],entityType:[{required:!0,message:"Please select Investor Type",trigger:"change"}],postcode:[{required:!0,message:"Please input Postcode",trigger:"blur"}],emailList:[{type:"array",required:!0,message:"Please input email",trigger:"blur"}]});H(async()=>{const i=[{email:v.value.email}];e.emailList=i,await w(),y.value&&A()});const h=async i=>{i&&await i.validate((t,n)=>{t?(console.log("submit!"),e.applicationFormSigned=f.value.length>0?f.value[0].raw:"",y.value?B():x()):(C.error("Please enter correct content!"),console.log("error submit!",n))})};async function w(){let i={type:"investment_entity_type"};const[t,n]=await V.queryDictionary(i);!t&&n&&(E.value=(n==null?void 0:n.data)||[])}async function x(){let i={...e,clientId:v.value.id};const t=e.emailList.map(r=>r.email);i.emailList=t;const[n,m]=await V.createEntity(i);!n&&m&&m.success&&(C.success("Created successfully"),setTimeout(()=>{T("entity")},1e3))}async function B(){let i={...e,id:y.value,clientId:v.value.id};const t=e.emailList.map(r=>r.email);i.emailList=t;const[n,m]=await V.editEntity(i);!n&&m&&m.success&&(C.success("Edit successfully"),setTimeout(()=>{T()},1e3))}function A(){if(console.log(u.value),u.value.emailList.length>0){const i=u.value.emailList.map(t=>({email:t}));e.emailList=i}if(u.value.entityType){const i=E.value.find(t=>t.code===u.value.entityType);e.entityType=i.value||""}e.addressLine=u.value.addressLine,e.bhgId=u.value.bhgId,e.entityName=u.value.entityName,e.suburb=u.value.suburb,e.state=u.value.state,e.postcode=u.value.postcode}const D=()=>{e.emailList.push({email:""})},K=i=>{e.emailList.splice(i,1)};return(i,t)=>{const n=X,m=Y,r=Z,d=ee,O=te,R=le,G=ae,j=se;return p(),c(I,null,[g("div",re,[g("div",ue,U(a(y)?"Edit Entity":"Create Entity"),1),g("div",null,[l(m,{type:"primary",color:"#4E9F1C",onClick:t[0]||(t[0]=s=>h(a(F)))},{default:o(()=>[S(U(a(y)?"Edit Entity":"Create Entity")+" ",1),l(n,null,{default:o(()=>[l(a(M))]),_:1})]),_:1})])]),g("div",de,[l(j,{ref_key:"ruleFormRef",ref:F,model:a(e),rules:a(q),"label-width":"200px","status-icon":""},{default:o(()=>[l(d,{label:"BHG ID",prop:"bhgId"},{default:o(()=>[l(r,{modelValue:a(e).bhgId,"onUpdate:modelValue":t[1]||(t[1]=s=>a(e).bhgId=s)},null,8,["modelValue"])]),_:1}),l(d,{label:"Investor Type",prop:"entityType"},{default:o(()=>[l(R,{modelValue:a(e).entityType,"onUpdate:modelValue":t[2]||(t[2]=s=>a(e).entityType=s),placeholder:"Select Investor Type"},{default:o(()=>[(p(!0),c(I,null,k(a(E),(s,_)=>(p(),$(O,{label:s.code,value:s.value,key:_},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"Entity Name",prop:"entityName"},{default:o(()=>[l(r,{modelValue:a(e).entityName,"onUpdate:modelValue":t[3]||(t[3]=s=>a(e).entityName=s)},null,8,["modelValue"])]),_:1}),l(d,{label:"Email",prop:"emailList"},{default:o(()=>[g("div",me,[(p(!0),c(I,null,k(a(e).emailList,(s,_)=>(p(),c("div",{key:_},[_===0?(p(),c("div",pe,[l(r,{modelValue:s.email,"onUpdate:modelValue":b=>s.email=b},null,8,["modelValue","onUpdate:modelValue"]),l(n,{class:"pointer",color:"#4E9F1C",size:"20",onClick:D},{default:o(()=>[l(a(J))]),_:1})])):(p(),c("div",ce,[l(r,{modelValue:s.email,"onUpdate:modelValue":b=>s.email=b},null,8,["modelValue","onUpdate:modelValue"]),l(n,{class:"pointer",color:"#E92C2C",size:"20",onClick:b=>K(_)},{default:o(()=>[l(a(Q))]),_:2},1032,["onClick"])]))]))),128))])]),_:1}),l(d,{label:"Address line",prop:"addressLine"},{default:o(()=>[l(r,{modelValue:a(e).addressLine,"onUpdate:modelValue":t[4]||(t[4]=s=>a(e).addressLine=s)},null,8,["modelValue"])]),_:1}),l(d,{label:"Suburb",prop:"suburb"},{default:o(()=>[l(r,{modelValue:a(e).suburb,"onUpdate:modelValue":t[5]||(t[5]=s=>a(e).suburb=s)},null,8,["modelValue"])]),_:1}),l(d,{label:"State",prop:"state"},{default:o(()=>[l(r,{modelValue:a(e).state,"onUpdate:modelValue":t[6]||(t[6]=s=>a(e).state=s)},null,8,["modelValue"])]),_:1}),l(d,{label:"Postcode",prop:"postcode"},{default:o(()=>[l(r,{modelValue:a(e).postcode,"onUpdate:modelValue":t[7]||(t[7]=s=>a(e).postcode=s)},null,8,["modelValue"])]),_:1}),l(d,{label:"Application form signed",prop:"applicationFormSigned"},{default:o(()=>[l(G,{"file-list":a(f),"onUpdate:fileList":t[8]||(t[8]=s=>W(f)?f.value=s:null),"auto-upload":!1,limit:1,"list-type":"text"},{trigger:o(()=>[l(m,{type:"primary"},{default:o(()=>[S("Choose file")]),_:1})]),_:1},8,["file-list"])]),_:1})]),_:1},8,["model","rules"])])],64)}}}),Fe=ie(ye,[["__scopeId","data-v-ccf9cde9"]]),Pe=Symbol("investment");export{Fe as C,Pe as I};
