import{a as w}from"./index-62d2fc31.js";/* empty css                   *//* empty css                 *//* empty css                 *//* empty css                   *//* empty css                  */import{i as ue,_ as Ee}from"./index-c38978f2.js";import{d as pe,o as me,r as b,D as ie,b as f,g as C,i as c,t as oe,f as a,e,w as s,k as P,a0 as ce,l as fe,F as D,h as $,c as Y,J as W,E as ve,Q as _e,N as be,O as Te,U as ke,a1 as ye,a2 as Ce,a3 as Ue,H as De,_ as Ve,a as Ie,a4 as re,a5 as xe,T as z,W as Ne,X as Pe,a6 as Ye,a7 as qe,a8 as Re,j as Se,v as Le,x as Ae,V as Me,a9 as $e,$ as Be,Y as Fe}from"./index-53be2c6b.js";import{u as ze}from"./AppMain.vue_vue_type_style_index_0_scoped_41d4e859_lang-05b22a52.js";/* empty css                     *//* empty css                  *//* empty css                       */import{P as ge}from"./index-e099722b.js";import{i as Oe}from"./validate-add6ff74.js";import{C as we}from"./CreatePurchase.vue_vue_type_style_index_0_scoped_ae31e1c8_lang-6c5e8563.js";/* empty css                    */import"./useUser-a1bf5fc0.js";const je={class:"pop-top"},Ke={class:"title"},We={class:"form"},He={key:0},Je={class:"add-container"},Qe=pe({__name:"CreateOrEditClient",setup(O){const{cId:g}=ue(we),{func:H}=ue(ge);me(async()=>{await K(),await Q(),await F(),g.value&&I()});const q=b([]),j=b([]),B=b([]),R=b(),t=ie({email:"",name:"",password:"asdf1234",password2:"asdf1234",countryCode:"",mobile:"",birth:"",beaverId:"",clientType:"",upperClient:"",level2UpperClientId:"",withheldTax:!1,tfNum:"",bsb:"",accountName:"",accountNumber:"",startDate:"",endDate:"",targetAmount:"",linkToValueup:!1,investmentCreateRequestList:[]}),L=ie({email:[{required:!0,message:"Please input Email",trigger:"blur"},{validator:(m,n,o)=>{n===""?o(new Error("Please input Email")):Oe(n)?o():o(new Error("Email format is incorrect!"))},trigger:"blur"}],password:[{required:!0,message:"Please input Password",trigger:"blur"},{min:8,max:16,message:"Length should be 8 to 16",trigger:"blur"}],password2:[{required:!0,message:"Please input Password",trigger:"blur"},{min:8,max:16,message:"Length should be 8 to 16",trigger:"blur"},{validator:(m,n,o)=>{n===""?o(new Error("Please input the Password again")):n!==t.password?o(new Error("Two inputs don't match!")):o()},trigger:"blur"}]}),A=async m=>{m&&await m.validate((n,o)=>{n?(console.log("submit!"),g.value?X():h()):(W.error("Please enter correct content!"),console.log("error submit!",o))})};async function K(){let m={};const[n,o]=await w.queryUpperClients(m);!n&&o&&(B.value=(o==null?void 0:o.data)||[])}async function Q(){let m={type:"client_type"};const[n,o]=await w.queryDictionary(m);!n&&o&&(j.value=(o==null?void 0:o.data)||[])}async function F(){let m={type:"investment_entity_type"};const[n,o]=await w.queryDictionary(m);!n&&o&&(q.value=(o==null?void 0:o.data)||[])}async function h(){let m=t;const[n,o]=await w.createClient(m);!n&&o&&o.success&&(W.success("Created successfully"),setTimeout(()=>{H()},1e3))}async function X(){let m={...t,id:g.value};const[n,o]=await w.editClient(m);!n&&o&&o.success&&(W.success("Edit successfully"),setTimeout(()=>{H()},1e3))}async function I(){var T,v,i,x,k,U,p,u,l,r,_,V,N,y,G,Z,ee,le,te;let m={id:g.value};const[n,o]=await w.queryClientDetailByIdWhenEdit(m);!n&&o&&(console.log(o.data),t.email=((T=o.data)==null?void 0:T.email)||"",t.name=((v=o.data)==null?void 0:v.name)||"",t.countryCode=((i=o.data)==null?void 0:i.countryCode)||"",t.mobile=((x=o.data)==null?void 0:x.mobile)||"",t.birth=((k=o.data)==null?void 0:k.birth)||"",t.beaverId=((U=o.data)==null?void 0:U.beaverId)||"",t.clientType=String((p=o.data)==null?void 0:p.clientType)||"",t.upperClient=((u=o.data)==null?void 0:u.upperClient)||"",t.level2UpperClientId=((l=o.data)==null?void 0:l.level2UpperClientId)||"",t.withheldTax=((r=o.data)==null?void 0:r.withheldTax)||!1,t.tfNum=((_=o.data)==null?void 0:_.tfNum)||"",t.bsb=((V=o.data)==null?void 0:V.bsb)||"",t.accountName=((N=o.data)==null?void 0:N.accountName)||"",t.accountNumber=((y=o.data)==null?void 0:y.accountNumber)||"",t.startDate=((G=o.data)==null?void 0:G.startDate)||"",t.endDate=((Z=o.data)==null?void 0:Z.endDate)||"",t.targetAmount=((ee=o.data)==null?void 0:ee.targetAmount)||"",t.linkToValueup=((le=o.data)==null?void 0:le.linkToValueup)||!1,t.investmentCreateRequestList=((te=o.data)==null?void 0:te.investmentCreateRequestList)||[])}const E=()=>{t.investmentCreateRequestList.push({entityName:"",entityType:"",kycResult:!1})},ae=m=>{t.investmentCreateRequestList.splice(m,1)},ne=()=>{t.targetAmount>999999.99?t.targetAmount=999999.99:t.targetAmount=t.targetAmount.replace(/^\./,"0.").match(/^\d*(\.?\d{0,2})/g)[0]||""};return(m,n)=>{const o=ve,T=_e,v=be,i=Te,x=ke,k=ye,U=Ce,p=Ue,u=De;return f(),C(D,null,[c("div",je,[c("div",Ke,oe(a(g)?"Edit Client":"Create Client"),1),c("div",null,[e(T,{type:"primary",color:"#4E9F1C",onClick:n[0]||(n[0]=l=>A(a(R)))},{default:s(()=>[P(oe(a(g)?"Edit Client":"New Client")+" ",1),e(o,null,{default:s(()=>[e(a(ce))]),_:1})]),_:1})])]),c("div",We,[e(u,{ref_key:"ruleFormRef",ref:R,model:a(t),rules:a(L),"label-width":"200px","status-icon":""},{default:s(()=>[e(i,{label:"Email",prop:"email"},{default:s(()=>[e(v,{modelValue:a(t).email,"onUpdate:modelValue":n[1]||(n[1]=l=>a(t).email=l)},null,8,["modelValue"])]),_:1}),a(g)?fe("",!0):(f(),C("div",He,[e(i,{label:"Password",prop:"password"},{default:s(()=>[e(v,{modelValue:a(t).password,"onUpdate:modelValue":n[2]||(n[2]=l=>a(t).password=l),type:"password",placeholder:"Please input password","show-password":""},null,8,["modelValue"])]),_:1}),e(i,{label:"Password confirmation",prop:"password2"},{default:s(()=>[e(v,{modelValue:a(t).password2,"onUpdate:modelValue":n[3]||(n[3]=l=>a(t).password2=l),type:"password",placeholder:"Please input password","show-password":""},null,8,["modelValue"])]),_:1})])),e(i,{label:"Name",prop:"name"},{default:s(()=>[e(v,{modelValue:a(t).name,"onUpdate:modelValue":n[4]||(n[4]=l=>a(t).name=l)},null,8,["modelValue"])]),_:1}),e(i,{label:"Country code",prop:"countryCode"},{default:s(()=>[e(v,{modelValue:a(t).countryCode,"onUpdate:modelValue":n[5]||(n[5]=l=>a(t).countryCode=l)},null,8,["modelValue"])]),_:1}),e(i,{label:"Mobile",prop:"mobile"},{default:s(()=>[e(v,{modelValue:a(t).mobile,"onUpdate:modelValue":n[6]||(n[6]=l=>a(t).mobile=l)},null,8,["modelValue"])]),_:1}),e(i,{label:"Birth",prop:"birth"},{default:s(()=>[e(x,{modelValue:a(t).birth,"onUpdate:modelValue":n[7]||(n[7]=l=>a(t).birth=l),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",clearable:""},null,8,["modelValue"])]),_:1}),e(i,{label:"Beaver id",prop:"beaverId"},{default:s(()=>[e(v,{modelValue:a(t).beaverId,"onUpdate:modelValue":n[8]||(n[8]=l=>a(t).beaverId=l)},null,8,["modelValue"])]),_:1}),e(i,{label:"Client type",prop:"clientType"},{default:s(()=>[e(U,{modelValue:a(t).clientType,"onUpdate:modelValue":n[9]||(n[9]=l=>a(t).clientType=l),placeholder:"Select Client type"},{default:s(()=>[(f(!0),C(D,null,$(a(j),(l,r)=>(f(),Y(k,{label:l.code,value:l.value,key:r},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"Level1 Upper Client",prop:"upperClient"},{default:s(()=>[e(U,{modelValue:a(t).upperClient,"onUpdate:modelValue":n[10]||(n[10]=l=>a(t).upperClient=l),placeholder:"Please Select"},{default:s(()=>[(f(!0),C(D,null,$(a(B),(l,r)=>(f(),Y(k,{label:l.name,value:l.id,key:r},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"Level2 Upper Client",prop:"level2UpperClientId"},{default:s(()=>[e(U,{modelValue:a(t).level2UpperClientId,"onUpdate:modelValue":n[11]||(n[11]=l=>a(t).level2UpperClientId=l),placeholder:"Please Select"},{default:s(()=>[(f(!0),C(D,null,$(a(B),(l,r)=>(f(),Y(k,{label:l.name,value:l.id,key:r},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"withheldTax",prop:"withheldTax"},{default:s(()=>[e(p,{modelValue:a(t).withheldTax,"onUpdate:modelValue":n[12]||(n[12]=l=>a(t).withheldTax=l),"active-text":"Yes","inactive-text":"No"},null,8,["modelValue"])]),_:1}),e(i,{label:"TFN",prop:"tfNum"},{default:s(()=>[e(v,{modelValue:a(t).tfNum,"onUpdate:modelValue":n[13]||(n[13]=l=>a(t).tfNum=l)},null,8,["modelValue"])]),_:1}),e(i,{label:"Bsb",prop:"bsb"},{default:s(()=>[e(v,{modelValue:a(t).bsb,"onUpdate:modelValue":n[14]||(n[14]=l=>a(t).bsb=l)},null,8,["modelValue"])]),_:1}),e(i,{label:"Account name",prop:"accountName"},{default:s(()=>[e(v,{modelValue:a(t).accountName,"onUpdate:modelValue":n[15]||(n[15]=l=>a(t).accountName=l)},null,8,["modelValue"])]),_:1}),e(i,{label:"Account number",prop:"accountNumber"},{default:s(()=>[e(v,{modelValue:a(t).accountNumber,"onUpdate:modelValue":n[16]||(n[16]=l=>a(t).accountNumber=l)},null,8,["modelValue"])]),_:1}),e(i,{label:"Start date",prop:"startDate"},{default:s(()=>[e(x,{modelValue:a(t).startDate,"onUpdate:modelValue":n[17]||(n[17]=l=>a(t).startDate=l),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",clearable:""},null,8,["modelValue"])]),_:1}),e(i,{label:"End date",prop:"endDate"},{default:s(()=>[e(x,{modelValue:a(t).endDate,"onUpdate:modelValue":n[18]||(n[18]=l=>a(t).endDate=l),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",clearable:""},null,8,["modelValue"])]),_:1}),e(i,{label:"Target amount",prop:"targetAmount"},{default:s(()=>[e(v,{modelValue:a(t).targetAmount,"onUpdate:modelValue":n[19]||(n[19]=l=>a(t).targetAmount=l),type:"number",onInput:ne},null,8,["modelValue"])]),_:1}),e(i,{label:"Link to valueup",prop:"linkToValueup"},{default:s(()=>[e(p,{modelValue:a(t).linkToValueup,"onUpdate:modelValue":n[20]||(n[20]=l=>a(t).linkToValueup=l)},null,8,["modelValue"])]),_:1}),e(i,{label:"Investment Entities",prop:"investmentCreateRequestList"},{default:s(()=>[c("div",Je,[e(T,{type:"success",onClick:E},{default:s(()=>[P("Add")]),_:1})]),(f(!0),C(D,null,$(a(t).investmentCreateRequestList,(l,r)=>(f(),C("div",{class:"inner-form",key:r},[e(i,{label:"Entity type"},{default:s(()=>[e(U,{filterable:"",clearable:"",modelValue:l.entityType,"onUpdate:modelValue":_=>l.entityType=_,placeholder:"please select","no-data-text":"no data"},{default:s(()=>[(f(!0),C(D,null,$(a(q),_=>(f(),Y(k,{key:_.code,label:_.code,value:_.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(i,{label:"Entity name"},{default:s(()=>[e(v,{modelValue:l.entityName,"onUpdate:modelValue":_=>l.entityName=_},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(i,{label:"Kyc result"},{default:s(()=>[e(p,{modelValue:l.kycResult,"onUpdate:modelValue":_=>l.kycResult=_},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(T,{type:"danger",onClick:_=>ae(r)},{default:s(()=>[P("Remove")]),_:2},1032,["onClick"])]))),128))]),_:1})]),_:1},8,["model","rules"])])],64)}}}),de=Ve(Qe,[["__scopeId","data-v-ff755b6e"]]),se=O=>(Le("data-v-5e3847c4"),O=O(),Ae(),O),Xe={class:"client"},Ge=se(()=>c("div",{class:"title"},"Client List",-1)),Ze={class:"tool-box"},el={class:"flex"},ll={class:"table"},tl=["onClick"],al={class:"pointer"},nl={class:"action"},ol=["onClick"],sl=["onClick"],ul=se(()=>c("span",null,"Are you sure to delete this?",-1)),il={class:"dialog-footer"},rl={class:"pagination"},dl=se(()=>c("div",null,null,-1)),pl=pe({__name:"index",setup(O){const{setBreadcrumbList:g}=ze(),H=Ie(),q=b(),j=b(!0),B=[{name:"add",component:de},{name:"edit",component:de}],R=b(null),t=[{value:0,label:"Client",name:"name"},{value:1,label:"Email",name:"email"},{value:2,label:"Mobile",name:"mobile"}],J=b([]),S=b(null),L=b(null),A=b(""),K=b([]),Q=b(0),F=b(10),h=b(1),X=b(null),I=b(!1);me(()=>{E(),ae()});async function E(){var _,V,N;R.value=null;let p={pageSize:F.value,pageNum:h.value},u={};S.value!==null&&(u={[t[S.value].name]:A.value}),L.value!==null&&(u={...u,clientType:(_=J.value[L.value])==null?void 0:_.value});const[l,r]=await w.queryClients(u,p);j.value=!1,!l&&r?(console.log(r.data),Q.value=((V=r.data)==null?void 0:V.total)||0,K.value=((N=r.data)==null?void 0:N.list)||[]):console.log(l)}async function ae(){let p={type:"client_type"};const[u,l]=await w.queryDictionary(p);!u&&l&&(J.value=(l==null?void 0:l.data)||[])}const ne=p=>{h.value=p,E()},m=()=>{S.value=null,A.value="",h.value=1,E()},n=()=>{h.value=1,E()},o=()=>{g([{name:"Create Client"}]),R.value=B.findIndex(p=>p.name==="add"),X.value=null,q.value.handleIsShow()},T=p=>{g([{name:`${p.name}`}]),H.push({path:`/client/detail/${p.id}`}).catch(u=>{console.warn(u)})},v=()=>{I.value=!0},i=async p=>{const u={id:p.id},[l,r]=await w.delClient(u);!l&&r&&(r.data&&W.success("delete success"),I.value=!1,E())},x=async p=>{const u={id:p.id},[l,r]=await w.resetClientPassword(u);!l&&r&&r.data&&W.success("reset success")},k=()=>{q.value&&q.value.handleIsShow()},U=()=>{E()};return re(ge,{func:k}),re(we,{cId:X}),(p,u)=>{const l=ye,r=Ce,_=be,V=_e,N=ve,y=Me,G=$e,Z=Be,ee=Ne,le=Fe,te=Pe,he=Ye;return f(),C(D,null,[xe((f(),C("div",Xe,[Ge,c("div",Ze,[c("div",el,[e(r,{class:"select",modelValue:a(S),"onUpdate:modelValue":u[0]||(u[0]=d=>z(S)?S.value=d:null),clearable:"",placeholder:"Filter by"},{default:s(()=>[(f(),C(D,null,$(t,d=>e(l,{key:d.value,label:d.label,value:d.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),e(_,{modelValue:a(A),"onUpdate:modelValue":u[1]||(u[1]=d=>z(A)?A.value=d:null),class:"m-lr-20 width-200",placeholder:"Search","prefix-icon":a(qe),clearable:""},null,8,["modelValue","prefix-icon"]),e(V,{class:"text-white",type:"primary",color:"#BE9670",onClick:n},{default:s(()=>[P(" Search ")]),_:1}),e(V,{class:"text-828282",type:"primary",color:"#E8E8E8",onClick:m},{default:s(()=>[P(" Clear ")]),_:1}),e(r,{class:"select m-l-20",modelValue:a(L),"onUpdate:modelValue":u[2]||(u[2]=d=>z(L)?L.value=d:null),clearable:"",placeholder:"Client type",onChange:U},{default:s(()=>[(f(!0),C(D,null,$(a(J),d=>(f(),Y(l,{key:d.value,label:d.code,value:d.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),c("div",null,[e(V,{type:"primary",color:"#4E9F1C",onClick:o},{default:s(()=>[P(" New Client "),e(N,null,{default:s(()=>[e(a(ce))]),_:1})]),_:1})])]),c("div",ll,[a(K).length>0?(f(),Y(ee,{key:0,data:a(K),height:"600","row-style":{height:"80px"}},{default:s(()=>[e(y,{prop:"id",label:"Client ID",align:"center",fixed:"left",width:"100"}),e(y,{prop:"name",label:"Client",align:"left",width:"180",fixed:"left"},{default:s(d=>[c("div",{class:"table-name pointer",onClick:M=>T(d.row)},[c("span",null,oe(d.row.name),1)],8,tl)]),_:1}),e(y,{prop:"birth",label:"Birth",align:"left",width:"150"}),e(y,{prop:"email",label:"Email",width:"200"}),e(y,{prop:"mobile",label:"Mobile",width:"200",align:"center"}),e(y,{prop:"clientType",label:"Client Type",width:"150",align:"center"}),e(y,{prop:"",label:"Total Investment Amount",width:"150"}),e(y,{prop:"",label:"Pervious Month Investment Return (End of month)",width:"150"}),e(y,{prop:"",label:"Total current Investment Return",width:"150"}),e(y,{prop:"",label:"Action",align:"center",fixed:"right"},{default:s(d=>[c("div",al,[e(Z,{placement:"bottom",width:170,trigger:"hover"},{reference:s(()=>[e(N,{size:30,color:"#969696"},{default:s(()=>[e(a(Re))]),_:1})]),default:s(()=>[c("div",nl,[c("div",{class:"item",onClick:M=>T(d.row)},"View",8,ol),c("div",{class:"item",onClick:M=>x(d.row)},"Reset password",8,sl),c("div",{class:"item",onClick:u[3]||(u[3]=M=>v())},"Delete"),e(G,{modelValue:a(I),"onUpdate:modelValue":u[5]||(u[5]=M=>z(I)?I.value=M:null),title:"Message",width:"30%","align-center":""},{footer:s(()=>[c("span",il,[e(V,{onClick:u[4]||(u[4]=M=>I.value=!1)},{default:s(()=>[P("Cancel")]),_:1}),e(V,{type:"primary",onClick:M=>i(d.row)},{default:s(()=>[P(" Confirm ")]),_:2},1032,["onClick"])])]),default:s(()=>[ul]),_:2},1032,["modelValue"])])]),_:2},1024)])]),_:1})]),_:1},8,["data"])):(f(),Y(le,{key:1,"image-size":200}))]),c("div",rl,[dl,e(te,{background:"",layout:"total,consists of sizes, prev, pager, next, jumper, ->, slot",total:a(Q),"page-size":a(F),"onUpdate:pageSize":u[6]||(u[6]=d=>z(F)?F.value=d:null),"current-page":a(h),"onUpdate:currentPage":u[7]||(u[7]=d=>z(h)?h.value=d:null),onCurrentChange:ne},null,8,["total","page-size","current-page"])])])),[[he,a(j)]]),e(a(Ee),{ref_key:"rightPanel",ref:q,onBackFn:E},{content:s(()=>[a(R)!==null?(f(),Y(Se(B[a(R)].component),{key:0})):fe("",!0)]),_:1},512)],64)}}});const Il=Ve(pl,[["__scopeId","data-v-5e3847c4"]]);export{Il as default};
