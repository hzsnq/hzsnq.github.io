import{a as B}from"./index-1beab65c.js";/* empty css                   *//* empty css                 *//* empty css                 *//* empty css                  *//* empty css                   *//* empty css                  */import{i as te,_ as Ce}from"./index-38ed8943.js";/* empty css                    */import"./useUser-7f9c8acd.js";/* empty css                       */import{d as ue,o as ce,r as u,D as le,am as qe,b as y,g as q,i as n,t as C,f as t,e,w as l,k as p,$ as me,F as G,h as ee,c as K,T as F,J,E as pe,P as _e,a1 as Ee,a2 as Ye,O as Ve,a0 as fe,N as ve,Q as Oe,ai as ke,H as Se,_ as he,v as Pe,x as xe,a4 as re,a5 as ze,Z as je,V as Ge,W as He,a6 as Ke,a7 as Je,an as Qe,a8 as We,j as Xe,l as Ze,ao as et,ah as tt,U as lt,ap as at,a9 as nt,X as ot}from"./index-298568e1.js";import{u as st}from"./AppMain.vue_vue_type_style_index_0_scoped_41d4e859_lang-b6e11d1a.js";/* empty css                     *//* empty css                */import{P as ye}from"./index-e099722b.js";import{E as it}from"./CreatOrEditEntity.vue_vue_type_style_index_0_scoped_3ce8e608_lang-39aa2ba5.js";import{C as dt}from"./CreatOrEditEntity-712a950e.js";const ge=Symbol("investment"),rt={class:"pop-top"},ut={class:"title"},ct={class:"form"},mt=ue({__name:"CreatOrEditInvestment",emits:["showEntity"],setup(M,{emit:w}){const{iId:k}=te(ge),{func:E,isRefresh:O}=te(ye);ce(async()=>{await v(),await N()});const _=u([]),$=u([]),Y=u([]),U=u([]),h=u(),a=le({clientId:"",fundId:"",entityId:"",transactionDate:"",purchasedAmount:"",unitCertificateDate:"",purchaseEndDate:"",applicationFormSigned:""}),g=le({clientId:[{required:!0,message:"Please select client",trigger:"change"}],fundId:[{required:!0,message:"Please select fund",trigger:"change"}],entityId:[{required:!0,message:"Please select entity",trigger:"change"}]});qe(()=>O.value,d=>{d&&a.clientId&&R()});const S=async d=>{d&&await d.validate((o,m)=>{o?(console.log("submit!"),a.applicationFormSigned=U.value.length>0?U.value[0].raw:"",H()):(J.error("Please enter correct content!"),console.log("error submit!",m))})};async function v(){let d={};const[o,m]=await B.getClientsNames(d);!o&&m&&(_.value=(m==null?void 0:m.data)||[])}async function N(){let d={};const[o,m]=await B.getFundsNames(d);!o&&m&&($.value=(m==null?void 0:m.data)||[])}const P=()=>{a.clientId?R():(a.entityId="",Y.value=[])};async function R(){if(!a.clientId)return;let d={clientId:a.clientId};const[o,m]=await B.queryEntity(d);!o&&m&&(console.log(m==null?void 0:m.data),Y.value=(m==null?void 0:m.data)||[])}async function H(){let d=a;const o=new FormData;Object.keys(d).forEach(b=>{[null,void 0,""].includes(d[b])||o.append(b,d[b])});const[m,T]=await B.createPurchasedFund(o);!m&&T&&T.success&&(J.success("Created successfully"),setTimeout(()=>{E()},1e3))}const f=()=>{a.clientId?w("showEntity",a.clientId):J.warning("Please select client first")};return(d,o)=>{const m=pe,T=_e,b=Ee,Q=Ye,A=Ve,W=fe,ae=ve,ne=Oe,oe=ke,se=Se;return y(),q(G,null,[n("div",rt,[n("div",ut,C(t(k)?"Edit Investment":"Create Investment"),1),n("div",null,[e(T,{type:"primary",color:"#4E9F1C",onClick:o[0]||(o[0]=r=>S(t(h)))},{default:l(()=>[p(C(t(k)?"Edit Investment":"New Investment")+" ",1),e(m,null,{default:l(()=>[e(t(me))]),_:1})]),_:1})])]),n("div",ct,[e(se,{ref_key:"ruleFormRef",ref:h,model:t(a),rules:t(g),"label-width":"200px","status-icon":""},{default:l(()=>[e(A,{label:"Client",prop:"clientId"},{default:l(()=>[e(Q,{modelValue:t(a).clientId,"onUpdate:modelValue":o[1]||(o[1]=r=>t(a).clientId=r),placeholder:"Please Client",filterable:"",clearable:"",onChange:P},{default:l(()=>[(y(!0),q(G,null,ee(t(_),(r,z)=>(y(),K(b,{label:r.name,value:r.id,key:z},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(A,{label:"Fund",prop:"fundId"},{default:l(()=>[e(Q,{modelValue:t(a).fundId,"onUpdate:modelValue":o[2]||(o[2]=r=>t(a).fundId=r),placeholder:"Please Fund",filterable:"",clearable:""},{default:l(()=>[(y(!0),q(G,null,ee(t($),(r,z)=>(y(),K(b,{label:r.name,value:r.id,key:z},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(A,{label:"Transaction Date",prop:"transactionDate"},{default:l(()=>[e(W,{modelValue:t(a).transactionDate,"onUpdate:modelValue":o[3]||(o[3]=r=>t(a).transactionDate=r),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",clearable:""},null,8,["modelValue"])]),_:1}),e(A,{label:"Purchase Amount",prop:"purchasedAmount"},{default:l(()=>[e(ae,{modelValue:t(a).purchasedAmount,"onUpdate:modelValue":o[4]||(o[4]=r=>t(a).purchasedAmount=r),type:"number"},null,8,["modelValue"])]),_:1}),e(A,{label:"U/C Date",prop:"unitCertificateDate"},{default:l(()=>[e(W,{modelValue:t(a).unitCertificateDate,"onUpdate:modelValue":o[5]||(o[5]=r=>t(a).unitCertificateDate=r),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",clearable:""},null,8,["modelValue"])]),_:1}),e(A,{label:"Purchase End Date",prop:"purchaseEndDate"},{default:l(()=>[e(W,{modelValue:t(a).purchaseEndDate,"onUpdate:modelValue":o[6]||(o[6]=r=>t(a).purchaseEndDate=r),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",clearable:""},null,8,["modelValue"])]),_:1}),e(A,{label:"Entity Name",prop:"entityName"},{default:l(()=>[e(Q,{modelValue:t(a).entityId,"onUpdate:modelValue":o[7]||(o[7]=r=>t(a).entityId=r),placeholder:"Please Entity Name",filterable:"",clearable:""},{default:l(()=>[(y(!0),q(G,null,ee(t(Y),(r,z)=>(y(),K(b,{label:r.entityName,value:r.id,key:z},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e(ne,{class:"p-t-10",type:"info",onClick:f},{default:l(()=>[p("Add new entity")]),_:1})]),_:1}),e(A,{label:"Application form signed",prop:"applicationFormSigned"},{default:l(()=>[e(oe,{"file-list":t(U),"onUpdate:fileList":o[8]||(o[8]=r=>F(U)?U.value=r:null),"auto-upload":!1,limit:1,"list-type":"text"},{trigger:l(()=>[e(T,{type:"primary"},{default:l(()=>[p("Choose file")]),_:1})]),_:1},8,["file-list"])]),_:1})]),_:1},8,["model","rules"])])],64)}}});const we=he(mt,[["__scopeId","data-v-dfe848ed"]]),pt=M=>(Pe("data-v-09a1b1c3"),M=M(),xe(),M),_t={class:"pop-top"},ft=pt(()=>n("div",{class:"title"},"Create Purchase",-1)),vt={class:"form"},ht=ue({__name:"Purchase",setup(M){const{info:w}=te(ge),{func:k}=te(ye);ce(()=>{_.clientId=w.value.clientId,_.fundId=w.value.fundId,_.entityId=w.value.entityId});const E=u([]),O=u(),_=le({clientId:"",fundId:"",entityId:"",transactionDate:"",purchasedAmount:"",unitCertificateDate:"",purchaseEndDate:"",applicationFormSigned:""}),$=le({}),Y=async h=>{h&&await h.validate((a,g)=>{a?(console.log("submit!"),_.applicationFormSigned=E.value.length>0?E.value[0].raw:"",U()):(J.error("Please enter correct content!"),console.log("error submit!",g))})};async function U(){let h=_;const a=new FormData;Object.keys(h).forEach(v=>{[null,void 0,""].includes(h[v])||a.append(v,h[v])});const[g,S]=await B.createPurchasedFund(a);!g&&S&&S.success&&(J.success("Created successfully"),setTimeout(()=>{k()},1e3))}return(h,a)=>{const g=pe,S=_e,v=Ve,N=fe,P=ve,R=ke,H=Se;return y(),q(G,null,[n("div",_t,[ft,n("div",null,[e(S,{type:"primary",color:"#4E9F1C",onClick:a[0]||(a[0]=f=>Y(t(O)))},{default:l(()=>[p(" Create Purchase "),e(g,null,{default:l(()=>[e(t(me))]),_:1})]),_:1})])]),n("div",vt,[e(H,{ref_key:"ruleFormRef",ref:O,model:t(_),rules:t($),"label-width":"200px","status-icon":""},{default:l(()=>[e(v,{label:"Client",prop:"clientId"},{default:l(()=>[p(C(t(w).clientName),1)]),_:1}),e(v,{label:"Fund",prop:"fundId"},{default:l(()=>[p(C(t(w).entityName),1)]),_:1}),e(v,{label:"Entity Name",prop:"entityName"},{default:l(()=>[p(C(t(w).fundName),1)]),_:1}),e(v,{label:"Transaction Date",prop:"transactionDate"},{default:l(()=>[e(N,{modelValue:t(_).transactionDate,"onUpdate:modelValue":a[1]||(a[1]=f=>t(_).transactionDate=f),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",clearable:""},null,8,["modelValue"])]),_:1}),e(v,{label:"Purchase Amount",prop:"purchasedAmount"},{default:l(()=>[e(P,{modelValue:t(_).purchasedAmount,"onUpdate:modelValue":a[2]||(a[2]=f=>t(_).purchasedAmount=f),type:"number"},null,8,["modelValue"])]),_:1}),e(v,{label:"U/C Date",prop:"unitCertificateDate"},{default:l(()=>[e(N,{modelValue:t(_).unitCertificateDate,"onUpdate:modelValue":a[3]||(a[3]=f=>t(_).unitCertificateDate=f),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",clearable:""},null,8,["modelValue"])]),_:1}),e(v,{label:"Purchase End Date",prop:"purchaseEndDate"},{default:l(()=>[e(N,{modelValue:t(_).purchaseEndDate,"onUpdate:modelValue":a[4]||(a[4]=f=>t(_).purchaseEndDate=f),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",clearable:""},null,8,["modelValue"])]),_:1}),e(v,{label:"Application form signed",prop:"applicationFormSigned"},{default:l(()=>[e(R,{"file-list":t(E),"onUpdate:fileList":a[5]||(a[5]=f=>F(E)?E.value=f:null),"auto-upload":!1,limit:1,"list-type":"text"},{trigger:l(()=>[e(S,{type:"primary"},{default:l(()=>[p("Choose file")]),_:1})]),_:1},8,["file-list"])]),_:1})]),_:1},8,["model","rules"])])],64)}}});const yt=he(ht,[["__scopeId","data-v-09a1b1c3"]]),L=M=>(Pe("data-v-3e9c8790"),M=M(),xe(),M),gt={class:"info"},bt={class:"item"},It=L(()=>n("div",{class:"name"},"Number of Investment",-1)),Dt={class:"number"},Ct={class:"item"},wt=L(()=>n("div",{class:"name"},"Total investment",-1)),Et={class:"number"},Yt={class:"item"},Vt=L(()=>n("div",{class:"name"},"Current investment return",-1)),kt={class:"number"},St={class:"item"},Pt=L(()=>n("div",{class:"name"},"Previous investment return",-1)),xt={class:"number"},Ft={class:"investment"},Mt=L(()=>n("div",{class:"title"},"Investment List",-1)),Ut={class:"tool-box"},Nt={class:"flex"},At={class:"flex"},$t={class:"email-select"},Bt=L(()=>n("div",{class:"title"},"Send to All",-1)),Lt={class:"email-select"},Rt=L(()=>n("div",{class:"title"},"Bulk Sending",-1)),Tt={class:"table"},qt={class:"pointer"},Ot={class:"action"},zt=["onClick"],jt=["onClick"],Gt=["onClick"],Ht=L(()=>n("span",null,"Are you sure to delete this?",-1)),Kt={class:"dialog-footer"},Jt={class:"pagination"},Qt=L(()=>n("div",null,null,-1)),Wt=ue({__name:"index",setup(M){const{setBreadcrumbList:w}=st(),k=u(),E=u(),O=u(!0),_=u(!1),$=[{name:"add",component:we},{name:"edit",component:we},{name:"purchase",component:yt}],Y=u(null),U=[{value:0,label:"Client",name:"email"},{value:1,label:"BHG ID",name:"bhgId"},{value:2,label:"Entity",name:"entityName"},{value:2,label:"Fund",name:"fundName"}],h=u({}),a=u(null),g=u(""),S=u([]),v=u(0),N=u(10),P=u(1),R=u(null),H=u({}),f=u(!1),d=u(1),o=u(null),m=u([]),T=u(null);ce(()=>{Q(),b()});async function b(){var X,V;Y.value=null;let c={pageSize:N.value,pageNum:P.value},s={};a.value!==null&&(s={[U[a.value].name]:g.value});const[I,D]=await B.queryInvestment(s,c);O.value=!1,!I&&D?(console.log(D.data.list),v.value=((X=D.data)==null?void 0:X.total)||0,S.value=((V=D.data)==null?void 0:V.list)||[]):console.log(I)}async function Q(){const c={},[s,I]=await B.queryGlobal(c);!s&&I?h.value=(I==null?void 0:I.data)||{}:console.log(s)}const A=c=>{P.value=c,b()},W=()=>{a.value=null,g.value="",P.value=1,b()},ae=()=>{P.value=1,b()},ne=()=>{w([{name:"Create Investment"}]),Y.value=$.findIndex(c=>c.name==="add"),R.value=null,k.value.handleIsShow()},oe=c=>{w([{name:"Edit Investment"}]),Y.value=$.findIndex(s=>s.name==="edit"),R.value=c.id,k.value.handleIsShow()},se=c=>{w([{name:"Create Purchase"}]),Y.value=$.findIndex(s=>s.name==="purchase"),H.value=c,k.value.handleIsShow()},r=()=>{f.value=!0},z=async c=>{c.id,c.pfId},Fe=c=>{c==="entity"?E.value&&(_.value=!0,E.value.handleIsShow()):k.value&&k.value.handleIsShow()},Me=c=>{console.log(typeof c,c)},be=async()=>{let c={startDate:o.value,idList:m.value,templateType:d.value};console.log(c)},Ue=async c=>{let s={id:c.id};const[I,D]=await B.sendUnitCertificate(s);!I&&D&&J.success("send success")},Ne=async c=>{let s={id:c};const[I,D]=await B.queryClientDetailById(s);!I&&D&&(T.value=(D==null?void 0:D.data)||{},E.value.handleIsShow())};return re(ye,{func:Fe,isRefresh:_}),re(ge,{iId:R,info:H}),re(it,{eId:u(null),clientInfo:T,entityInfo:{}}),(c,s)=>{const I=Ee,D=Ye,X=ve,V=_e,ie=pe,Z=et,Ie=tt,De=fe,de=je,x=lt,Ae=at,$e=nt,Be=Ge,Le=ot,Re=He,Te=Ke;return y(),q(G,null,[n("div",gt,[n("div",bt,[It,n("div",Dt,C(t(h).investmentCount),1)]),n("div",Ct,[wt,n("div",Et,"$"+C(t(h).totalInvestment||0),1)]),n("div",Yt,[Vt,n("div",kt,"$"+C(t(h).currentReturn||0),1)]),n("div",St,[Pt,n("div",xt,"$"+C(t(h).previousInvestment||0),1)])]),ze((y(),q("div",Ft,[Mt,n("div",Ut,[n("div",Nt,[e(D,{class:"select",modelValue:t(a),"onUpdate:modelValue":s[0]||(s[0]=i=>F(a)?a.value=i:null),clearable:"",placeholder:"Filter by"},{default:l(()=>[(y(),q(G,null,ee(U,i=>e(I,{key:i.value,label:i.label,value:i.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),e(X,{modelValue:t(g),"onUpdate:modelValue":s[1]||(s[1]=i=>F(g)?g.value=i:null),class:"m-lr-20",placeholder:"Search","prefix-icon":t(Je),clearable:""},null,8,["modelValue","prefix-icon"]),e(V,{class:"text-white",type:"primary",color:"#BE9670",onClick:ae},{default:l(()=>[p(" Search ")]),_:1}),e(V,{class:"text-828282",type:"primary",color:"#E8E8E8",onClick:W},{default:l(()=>[p(" Clear ")]),_:1})]),n("div",At,[e(V,{type:"primary",color:"#4E9F1C",onClick:ne},{default:l(()=>[p(" New Investment "),e(ie,null,{default:l(()=>[e(t(me))]),_:1})]),_:1}),e(de,{placement:"bottom",width:255,trigger:"click"},{reference:l(()=>[e(V,{class:"text-white",type:"primary",color:"#BE9670"},{default:l(()=>[p(" Send to All ")]),_:1})]),default:l(()=>[n("div",$t,[Bt,e(Ie,{modelValue:t(d),"onUpdate:modelValue":s[2]||(s[2]=i=>F(d)?d.value=i:null)},{default:l(()=>[e(Z,{label:1},{default:l(()=>[p("Month")]),_:1}),e(Z,{label:2},{default:l(()=>[p("Year")]),_:1})]),_:1},8,["modelValue"]),e(De,{modelValue:t(o),"onUpdate:modelValue":s[3]||(s[3]=i=>F(o)?o.value=i:null),type:t(d)===1?"month":"year",placeholder:t(d)===1?"Pick a month":"Pick a year",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue","type","placeholder"]),e(V,{class:"text-white m-tb-20",type:"primary",color:"#BE9670",onClick:be},{default:l(()=>[p(" Send ")]),_:1})])]),_:1}),e(de,{placement:"bottom",width:255,trigger:"click"},{reference:l(()=>[e(V,{class:"text-white",type:"primary",color:"#BE9670"},{default:l(()=>[p(" Bulk sending "),e(ie,null,{default:l(()=>[e(t(Qe))]),_:1})]),_:1})]),default:l(()=>[n("div",Lt,[Rt,e(Ie,{modelValue:t(d),"onUpdate:modelValue":s[4]||(s[4]=i=>F(d)?d.value=i:null)},{default:l(()=>[e(Z,{label:1},{default:l(()=>[p("Month")]),_:1}),e(Z,{label:2},{default:l(()=>[p("Year")]),_:1})]),_:1},8,["modelValue"]),e(De,{modelValue:t(o),"onUpdate:modelValue":s[5]||(s[5]=i=>F(o)?o.value=i:null),type:t(d)===1?"month":"year",placeholder:t(d)===1?"Pick a month":"Pick a year",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue","type","placeholder"]),e(V,{class:"text-white m-tb-20",type:"primary",color:"#BE9670",onClick:be},{default:l(()=>[p(" Send ")]),_:1})])]),_:1})])]),n("div",Tt,[t(S).length>0?(y(),K(Be,{key:0,data:t(S),height:"600","row-style":{height:"80px"},onSelectionChange:Me},{default:l(()=>[e(x,{type:"selection",width:"55",fixed:"left"}),e(x,{prop:"clientName",label:"Client",align:"center",width:"150",fixed:"left"}),e(x,{prop:"bhgId",label:"BHG ID",align:"left",width:"150"}),e(x,{prop:"entityName",label:"Entity",align:"left",width:"150"}),e(x,{prop:"fundName",label:"Fund",width:"200"}),e(x,{prop:"currentReturn",label:"Current investment return",width:"150",align:"center"},{default:l(i=>[n("span",null,"$"+C(i.row.currentReturn),1)]),_:1}),e(x,{prop:"totalReturn",label:"Total investment return",width:"150",align:"center"},{default:l(i=>[n("span",null,"$"+C(i.row.totalReturn),1)]),_:1}),e(x,{prop:"purchasedAmount",label:"Investment amount",width:"150",align:"center"},{default:l(i=>[n("span",null,"$"+C(i.row.purchasedAmount),1)]),_:1}),e(x,{prop:"recordCount",label:"Investment Record",width:"150",align:"center"}),e(x,{prop:"status",label:"Investment Status",width:"150",align:"center"},{default:l(i=>[e(Ae,{class:"text-white",color:i.row.status==="On-Going"?"#4E9F1C":"#BE9670"},{default:l(()=>[p(C(i.row.status),1)]),_:2},1032,["color"])]),_:1}),e(x,{prop:"",label:"Action",align:"center",fixed:"right"},{default:l(i=>[n("div",qt,[e(de,{placement:"bottom",width:170,trigger:"hover"},{reference:l(()=>[e(ie,{size:30,color:"#969696"},{default:l(()=>[e(t(We))]),_:1})]),default:l(()=>[n("div",Ot,[n("div",{class:"item",onClick:j=>se(i.row)},"Purchase",8,zt),n("div",{class:"item",onClick:j=>oe(i.row)},"Edit",8,jt),n("div",{class:"item",onClick:s[6]||(s[6]=j=>r())},"Delete"),n("div",{class:"item",onClick:j=>Ue(i.row)},"Send",8,Gt),e($e,{modelValue:t(f),"onUpdate:modelValue":s[8]||(s[8]=j=>F(f)?f.value=j:null),title:"Message",width:"30%","align-center":""},{footer:l(()=>[n("span",Kt,[e(V,{onClick:s[7]||(s[7]=j=>f.value=!1)},{default:l(()=>[p("Cancel")]),_:1}),e(V,{type:"primary",onClick:j=>z(i.row)},{default:l(()=>[p(" Confirm ")]),_:2},1032,["onClick"])])]),default:l(()=>[Ht]),_:2},1032,["modelValue"])])]),_:2},1024)])]),_:1})]),_:1},8,["data"])):(y(),K(Le,{key:1,"image-size":200}))]),n("div",Jt,[Qt,e(Re,{background:"",layout:"total,consists of sizes, prev, pager, next, jumper, ->, slot",total:t(v),"page-size":t(N),"onUpdate:pageSize":s[9]||(s[9]=i=>F(N)?N.value=i:null),"current-page":t(P),"onUpdate:currentPage":s[10]||(s[10]=i=>F(P)?P.value=i:null),onCurrentChange:A},null,8,["total","page-size","current-page"])])])),[[Te,t(O)]]),e(t(Ce),{ref_key:"rightPanel",ref:k,onBackFn:b},{content:l(()=>[t(Y)!==null?(y(),K(Xe($[t(Y)].component),{key:0,onShowEntity:Ne},null,32)):Ze("",!0)]),_:1},512),e(t(Ce),{ref_key:"rightPanel2",ref:E,onBackFn:()=>{}},{content:l(()=>[e(t(dt))]),_:1},512)],64)}}});const vl=he(Wt,[["__scopeId","data-v-3e9c8790"]]);export{vl as default};
