import{a as T}from"./index-35b0e3a1.js";/* empty css                   *//* empty css                 *//* empty css                 *//* empty css                *//* empty css                  */import{i as G,_ as Ce}from"./index-79b2cd3e.js";import{d as Z,o as H,r as f,G as le,b as p,h,j as o,t as g,g as e,f as t,e as l,l as y,a1 as ne,c as $,F as z,i as ie,m as se,K as W,E as ce,R as re,a4 as Ne,a2 as de,a3 as ue,P as Ae,O as _e,I as Ve,_ as J,S as X,an as xe,ao as Ee,x as pe,y as me,a5 as ae,a6 as Ie,a7 as K,U,X as ke,Y as Se,a8 as De,a9 as Pe,aa as $e,k as Ye,W as Me,ab as Fe,a0 as Ue,Z as Te}from"./index-5a0eb1b1.js";import{u as ze}from"./AppMain.vue_vue_type_style_index_0_scoped_41d4e859_lang-bdfc2e53.js";/* empty css                     *//* empty css                  */import{P as fe}from"./index-e099722b.js";/* empty css                             */import"./useUser-46e05e2c.js";const Q=Symbol("notification"),Be={class:"pop-top"},je={class:"title"},Le={class:"form"},qe={class:"flex-select"},Re=Z({__name:"CreateOrEditNotification",setup(b){const{nId:A}=G(Q),{func:u}=G(fe);H(()=>{a(),A.value});const w=f([]),V=f(),n=le({isAll:!1,clientIdArr:[],clientNameArr:[],title:"",message:""}),_=le({isAll:[{required:!0,message:"Please select client",trigger:"change"}],title:[{required:!0,message:"Please input title",trigger:"blur"}],message:[{required:!0,message:"Please input message",trigger:"blur"}]}),C=async d=>{d&&await d.validate((i,s)=>{i?(console.log("submit!"),A.value||E()):(W.error("Please enter correct content!"),console.log("error submit!",s))})};async function a(){let d={};const[i,s]=await T.getClientsNames(d);!i&&s&&(w.value=(s==null?void 0:s.data)||[])}async function E(){let d=n;console.log(d);const[i,s]=await T.createNotification(d);!i&&s&&s.success&&(W.success("Created successfully"),setTimeout(()=>{u()},1e3))}const k=()=>{n.isAll&&(n.clientNameArr=[],n.clientIdArr=[])},S=d=>{let i=[];for(let s=0;s<w.value.length;s++)for(let v=0;v<d.length;v++)w.value[s].id===d[v]&&i.push(w.value[s].name);n.clientNameArr=i};return(d,i)=>{const s=ce,v=re,L=Ne,q=de,R=ue,Y=Ae,B=_e,O=Ve;return p(),h(z,null,[o("div",Be,[o("div",je,g(e(A)?"Edit notification":"Create notification"),1),o("div",null,[t(v,{type:"primary",color:"#4E9F1C",onClick:i[0]||(i[0]=m=>C(e(V)))},{default:l(()=>[y(g(e(A)?"Edit notification":"New notification")+" ",1),t(s,null,{default:l(()=>[t(e(ne))]),_:1})]),_:1})])]),o("div",Le,[t(O,{ref_key:"ruleFormRef",ref:V,model:e(n),rules:e(_),"label-width":"200px","status-icon":""},{default:l(()=>[t(Y,{label:"Client",prop:"isAll"},{default:l(()=>[o("div",qe,[t(L,{modelValue:e(n).isAll,"onUpdate:modelValue":i[1]||(i[1]=m=>e(n).isAll=m),"active-text":"All","inactive-text":"No",onChange:k},null,8,["modelValue"]),e(n).isAll?se("",!0):(p(),$(R,{key:0,modelValue:e(n).clientIdArr,"onUpdate:modelValue":i[2]||(i[2]=m=>e(n).clientIdArr=m),multiple:"",placeholder:"Select",filterable:"",style:{width:"500px"},onChange:S},{default:l(()=>[(p(!0),h(z,null,ie(e(w),m=>(p(),$(q,{key:m.id,label:m.name,value:m.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]))])]),_:1}),t(Y,{label:"Title",prop:"title"},{default:l(()=>[t(B,{modelValue:e(n).title,"onUpdate:modelValue":i[3]||(i[3]=m=>e(n).title=m)},null,8,["modelValue"])]),_:1}),t(Y,{label:"Message",prop:"message"},{default:l(()=>[t(B,{modelValue:e(n).message,"onUpdate:modelValue":i[4]||(i[4]=m=>e(n).message=m),type:"textarea",autosize:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])],64)}}});const oe=J(Re,[["__scopeId","data-v-3311a6c7"]]),Oe=b=>(pe("data-v-12d17844"),b=b(),me(),b),Ke=Oe(()=>o("div",{class:"pop-top"},[o("div",{class:"title"},"View notification"),o("div")],-1)),Ge={class:"form"},We={key:0},Xe={key:1},Ze=Z({__name:"ViewNotification",setup(b){const{nId:A}=G(Q),u=f({});H(()=>{w()});async function w(){let V={id:A.value};const[n,_]=await T.queryNotificationById(V);!n&&_&&(console.log(_.data),u.value=(_==null?void 0:_.data)||{})}return(V,n)=>{const _=xe,C=Ee;return p(),h(z,null,[Ke,o("div",Ge,[t(C,{column:1,border:""},{default:l(()=>[t(_,{label:"ID","label-align":"center",align:"center"},{default:l(()=>{var a;return[y(g((a=e(u))==null?void 0:a.id),1)]}),_:1}),t(_,{label:"Title","label-align":"center",align:"center"},{default:l(()=>{var a;return[y(g((a=e(u))==null?void 0:a.title),1)]}),_:1}),t(_,{label:"Message","label-align":"center",align:"center"},{default:l(()=>{var a;return[y(g(((a=e(u))==null?void 0:a.message)||"EMPTY"),1)]}),_:1}),t(_,{label:"Client","label-align":"center",align:"center"},{default:l(()=>{var a,E,k;return[(a=e(u))!=null&&a.isAll?(p(),h("div",We,"All")):(p(),h("div",Xe,g((E=e(u))!=null&&E.clientNameArr?(k=e(u))==null?void 0:k.clientNameArr.join(","):""),1))]}),_:1}),t(_,{label:"Created At","label-align":"center",align:"center"},{default:l(()=>{var a;return[y(g(e(X)((a=e(u))==null?void 0:a.createdAt).format("DD.MM.YYYY")),1)]}),_:1}),t(_,{label:"Updated At","label-align":"center",align:"center"},{default:l(()=>{var a;return[y(g(e(X)((a=e(u))==null?void 0:a.updatedAt).format("DD.MM.YYYY")),1)]}),_:1})]),_:1})])],64)}}});const He=J(Ze,[["__scopeId","data-v-12d17844"]]),ee=b=>(pe("data-v-f7c2c70d"),b=b(),me(),b),Je={class:"Notification"},Qe=ee(()=>o("div",{class:"title"},"Notification List",-1)),et={class:"tool-box"},tt={class:"flex"},lt={class:"table"},at={class:"table-name"},ot={class:"table-cut"},nt={key:0},it={key:1},st={class:"pointer"},ct={class:"action"},rt=["onClick"],dt=ee(()=>o("span",null,"Are you sure to delete this?",-1)),ut={class:"dialog-footer"},_t={class:"pagination"},pt=ee(()=>o("div",null,null,-1)),mt=Z({__name:"index",setup(b){const{setBreadcrumbList:A}=ze(),u=f(),w=f(!0),V=[{name:"view",component:He},{name:"add",component:oe},{name:"edit",component:oe}],n=f(null),_=[{value:0,label:"Client",name:"clientId"}],C=f(null),a=f(""),E=f([]),k=f(0),S=f(10),d=f(1),i=f(null),s=f(!1);H(()=>{v()});async function v(){var j,I,M;n.value=null;let N={pageSize:S.value,pageNum:d.value},r={};C.value!==null&&(r={[_[C.value].name]:a.value});const[D,x]=await T.queryNotificationPage(r,N);w.value=!1,!D&&x?(console.log((j=x.data)==null?void 0:j.list),k.value=((I=x.data)==null?void 0:I.total)||0,E.value=((M=x.data)==null?void 0:M.list)||[]):console.log(D)}const L=N=>{d.value=N,v()},q=()=>{C.value=null,a.value="",d.value=1,v()},R=()=>{d.value=1,v()},Y=()=>{A([{name:"Create Notification"}]),n.value=V.findIndex(N=>N.name==="add"),i.value=null,u.value.handleIsShow()},B=N=>{A([{name:"View Notification"}]),n.value=V.findIndex(r=>r.name==="view"),i.value=N.id,u.value.handleIsShow()},O=()=>{s.value=!0},m=async N=>{const r={id:N.id},[D,x]=await T.delNotification(r);!D&&x&&(x.data&&W.success("delete success"),s.value=!1,v())};return ae(fe,{func:()=>{u.value&&u.value.handleIsShow()}}),ae(Q,{nId:i}),(N,r)=>{const D=de,x=ue,j=_e,I=re,M=ce,P=Me,ve=Fe,ge=Ue,he=ke,ye=Te,be=Se,te=Ie("permission"),we=De;return p(),h(z,null,[K((p(),h("div",Je,[Qe,o("div",et,[o("div",tt,[t(x,{class:"select",modelValue:e(C),"onUpdate:modelValue":r[0]||(r[0]=c=>U(C)?C.value=c:null),clearable:"",placeholder:"Filter by"},{default:l(()=>[(p(),h(z,null,ie(_,c=>t(D,{key:c.value,label:c.label,value:c.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),t(j,{modelValue:e(a),"onUpdate:modelValue":r[1]||(r[1]=c=>U(a)?a.value=c:null),class:"m-lr-20",placeholder:"Search","prefix-icon":e(Pe),clearable:""},null,8,["modelValue","prefix-icon"]),t(I,{class:"text-white",type:"primary",color:"#BE9670",onClick:R},{default:l(()=>[y(" Search ")]),_:1}),t(I,{class:"text-828282",type:"primary",color:"#E8E8E8",onClick:q},{default:l(()=>[y(" Clear ")]),_:1})]),o("div",null,[K((p(),$(I,{type:"primary",color:"#4E9F1C",onClick:Y},{default:l(()=>[y(" New Notification "),t(M,null,{default:l(()=>[t(e(ne))]),_:1})]),_:1})),[[te,"Notification"]])])]),o("div",lt,[e(E).length>0?(p(),$(he,{key:0,data:e(E),height:"600","row-style":{height:"80px"}},{default:l(()=>[t(P,{prop:"id",label:"Notification ID",align:"center",width:"130"},{default:l(c=>[o("div",at,[o("span",null,g(c.row.id),1)])]),_:1}),t(P,{prop:"title",label:"Title",align:"center",width:"200"}),t(P,{prop:"message",label:"Message",align:"center",width:"300"},{default:l(c=>[o("div",ot,g(c.row.message),1)]),_:1}),t(P,{prop:"createdAt",label:"Create at",width:"200"},{default:l(c=>[o("span",null,g(e(X)(c.row.createdAt).format("DD.MM.YYYY")),1)]),_:1}),t(P,{prop:"clientNameArr",label:"Client",width:"200"},{default:l(c=>[c.row.isAll?(p(),h("div",nt,"All")):(p(),h("div",it,g(c.row.clientNameArr.join(",")),1))]),_:1}),t(P,{prop:"",label:"Action",align:"center",fixed:"right"},{default:l(c=>[o("div",st,[t(ge,{placement:"bottom",width:170,trigger:"hover"},{reference:l(()=>[t(M,{size:30,color:"#969696"},{default:l(()=>[t(e($e))]),_:1})]),default:l(()=>[K((p(),h("div",ct,[o("div",{class:"item",onClick:F=>B(c.row)},"View",8,rt),o("div",{class:"item",onClick:r[2]||(r[2]=F=>O())},"Delete"),t(ve,{modelValue:e(s),"onUpdate:modelValue":r[4]||(r[4]=F=>U(s)?s.value=F:null),title:"Message",width:"30%","align-center":""},{footer:l(()=>[o("span",ut,[t(I,{onClick:r[3]||(r[3]=F=>s.value=!1)},{default:l(()=>[y("Cancel")]),_:1}),t(I,{type:"primary",onClick:F=>m(c.row)},{default:l(()=>[y(" Confirm ")]),_:2},1032,["onClick"])])]),default:l(()=>[dt]),_:2},1032,["modelValue"])])),[[te,"Notification"]])]),_:2},1024)])]),_:1})]),_:1},8,["data"])):(p(),$(ye,{key:1,"image-size":200}))]),o("div",_t,[pt,t(be,{background:"",layout:"total,consists of sizes, prev, pager, next, jumper, ->, slot",total:e(k),"page-size":e(S),"onUpdate:pageSize":r[5]||(r[5]=c=>U(S)?S.value=c:null),"current-page":e(d),"onUpdate:currentPage":r[6]||(r[6]=c=>U(d)?d.value=c:null),onCurrentChange:L},null,8,["total","page-size","current-page"])])])),[[we,e(w)]]),t(e(Ce),{ref_key:"rightPanel",ref:u,onBackFn:v},{content:l(()=>[e(n)!==null?(p(),$(Ye(V[e(n)].component),{key:0})):se("",!0)]),_:1},512)],64)}}});const St=J(mt,[["__scopeId","data-v-f7c2c70d"]]);export{St as default};
