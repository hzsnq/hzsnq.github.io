import{a as C}from"./index-1beab65c.js";/* empty css                     *//* empty css                */import{u as H}from"./useUser-7f9c8acd.js";/* empty css                 */import{d as z,r as S,o as K,C as M,u as q,a as D,D as V,b as L,g as T,i as b,f as o,c as I,w as h,G as P,H as $,v as N,x as G,I as W,J as Y,e as f,K as B,L as J,k as F,M as O,N as Q,O as X,P as Z,Q as ee,_ as te}from"./index-298568e1.js";import{_ as re}from"./bhg-logo-5b729188.js";import{i as oe}from"./validate-add6ff74.js";function A(){return A=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(i[c]=t[c])}return i},A.apply(this,arguments)}var ae=function(){var e=!1,t=[],c=function(){if(!e){e=!0;for(var l=0,y=t.length;l<y;l++)t[l]()}},u=function(l){if(!e){t.push(l);return}l()},w={resolved:function(){return e},resolve:c,promise:{then:u}};return w},j=Object.prototype.hasOwnProperty;function ne(){var i=ae();return{notify:function(){i.resolve()},wait:function(){return i.promise},render:function(t,c,u){this.wait().then(function(){u(window.grecaptcha.render(t,c))})},reset:function(t){typeof t>"u"||(this.assertLoaded(),this.wait().then(function(){return window.grecaptcha.reset(t)}))},execute:function(t){typeof t>"u"||(this.assertLoaded(),this.wait().then(function(){return window.grecaptcha.execute(t)}))},checkRecaptchaLoad:function(){j.call(window,"grecaptcha")&&j.call(window.grecaptcha,"render")&&this.notify()},assertLoaded:function(){if(!i.resolved())throw new Error("ReCAPTCHA has not been loaded")}}}var R=ne();typeof window<"u"&&(window.vueRecaptchaApiLoaded=R.notify);var se=z({name:"VueRecaptcha",props:{sitekey:{type:String,required:!0},theme:{type:String},badge:{type:String},type:{type:String},size:{type:String},tabindex:{type:String},loadRecaptchaScript:{type:Boolean,default:!0},recaptchaScriptId:{type:String,default:"__RECAPTCHA_SCRIPT"},recaptchaHost:{type:String,default:"www.google.com"},language:{type:String,default:""}},emits:["render","verify","expired","error"],setup:function(e,t){var c=t.slots,u=t.emit,w=S(null),g=S(null),l=function(_){u("verify",_)},y=function(){u("expired")},n=function(){u("error")};return K(function(){if(R.checkRecaptchaLoad(),e.loadRecaptchaScript&&!document.getElementById(e.recaptchaScriptId)){var a=document.createElement("script");a.id=e.recaptchaScriptId,a.src="https://"+e.recaptchaHost+"/recaptcha/api.js?onload=vueRecaptchaApiLoaded&render=explicit&hl="+e.language,a.async=!0,a.defer=!0,document.head.appendChild(a)}var _=A({},e,{callback:l,"expired-callback":y,"error-callback":n}),x=w.value,p=c.default?x.children[0]:x;R.render(p,_,function(r){g.value=r,u("render",r)})}),{root:w,widgetId:g,reset:function(){R.reset(g.value)},execute:function(){R.execute(g.value)}}},render:function(){var e=this.$slots.default,t;return typeof e=="function"?t=e():t=e,M("div",{ref:"root"},t)}});const ie=i=>(N("data-v-e4b8e426"),i=i(),G(),i),le={class:"login-container"},de={class:"login-card"},ce=ie(()=>b("div",{class:"title"},[b("img",{src:re})],-1)),ue={class:"content"},pe={class:"flex"},me=z({__name:"index",setup(i){const e=q(),t=S("login"),c=D(),u=S(),w=S(),{setUserInfo:g}=H();let l=[];l["Super Admin"]="superAdmin",l["Fund Admin"]="fundAdmin",l["Fund Operation"]="fundOperation",l["Web Admin"]="webAdmin";const y=(p,r,m)=>{r===""?m(new Error("Please input Email")):oe(r)?m():m(new Error("Email format is incorrect!"))},n=V({loading:!1,loginForm:{username:"",password:""},loginRules:{username:[{required:!0,message:"please enter email",trigger:"blur"}],password:[{required:!0,message:"Please enter password",trigger:"blur"}]},handleLogin:()=>{u.value.validate(async p=>{var r;if(p){n.loading=!0;const m={adminUserEmail:n.loginForm.username,password:n.loginForm.password},[v,s]=await C.userLogin(m);if(!v&&s)if(s!=null&&s.success){const E=(r=s==null?void 0:s.data)!=null&&r.roles?[l[s==null?void 0:s.data.roles[0]]]:[];let k={token:s.data.token,roles:E,adminEmail:s.data.adminEmail};g(k),n.loading=!1;try{const d=k.roles;e.setRoutes(d),e.dynamicRoutes.forEach(U=>{W.addRoute(U)})}catch(d){console.log(d)}c.push({path:E[0]==="webAdmin"?"/investment":"/"}).catch(d=>{console.warn(d)})}else n.loading=!1;else console.log(v)}else return!1})}}),a=V({loading:!1,resetForm:{username:""},resetRules:{username:[{required:!0,message:"please enter email",trigger:"blur"},{validator:y,trigger:"blur"}]},handleReset:()=>{w.value.validate(async p=>{if(p){n.loading=!0;const r={adminEmail:a.resetForm.username},[m,v]=await C.sendPasswordResetEmail(r);!m&&v&&(n.loading=!1,Y.success("Send email success"))}else return!1})}}),_=p=>{window.localStorage.setItem("g-recaptcha-response",p)},x=p=>{t.value=p};return(p,r)=>{const m=Q,v=X,s=Z,E=ee,k=$;return L(),T("div",le,[b("div",de,[ce,b("div",ue,[o(t)==="login"?(L(),I(k,{key:0,ref_key:"loginFormDom",ref:u,model:o(n).loginForm,rules:o(n).loginRules,onKeyup:P(o(n).handleLogin,["enter"])},{default:h(()=>[f(v,{prop:"username"},{default:h(()=>[f(m,{modelValue:o(n).loginForm.username,"onUpdate:modelValue":r[0]||(r[0]=d=>o(n).loginForm.username=d),placeholder:"Email",type:"text",tabindex:"1","prefix-icon":o(B),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1}),f(v,{prop:"password"},{default:h(()=>[f(m,{modelValue:o(n).loginForm.password,"onUpdate:modelValue":r[1]||(r[1]=d=>o(n).loginForm.password=d),placeholder:"Password",type:"password",tabindex:"2","prefix-icon":o(J),size:"large","show-password":""},null,8,["modelValue","prefix-icon"])]),_:1}),b("div",pe,[f(o(se),{sitekey:"6LcWhv4jAAAAACe2U7tz5Rhstqkf-whriMrj3YYG",onVerify:_})]),f(s,{loading:o(n).loading,type:"primary",size:"large",color:"#BE9670",onClick:O(o(n).handleLogin,["prevent"])},{default:h(()=>[F(" Log in ")]),_:1},8,["loading","onClick"]),f(E,{class:"p-t-10",type:"info",onClick:r[2]||(r[2]=d=>x("reset"))},{default:h(()=>[F("Forgot your password?")]),_:1})]),_:1},8,["model","rules","onKeyup"])):(L(),I(k,{key:1,ref_key:"resetFormDom",ref:w,model:o(a).resetForm,rules:o(a).resetRules,onKeyup:P(o(a).handleReset,["enter"])},{default:h(()=>[f(v,{prop:"username"},{default:h(()=>[f(m,{modelValue:o(a).resetForm.username,"onUpdate:modelValue":r[3]||(r[3]=d=>o(a).resetForm.username=d),placeholder:"Email",type:"text",tabindex:"1","prefix-icon":o(B),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1}),f(s,{loading:o(a).loading,type:"primary",size:"large",color:"#BE9670",onClick:O(o(a).handleReset,["prevent"])},{default:h(()=>[F(" Send me reset password instructions ")]),_:1},8,["loading","onClick"]),f(E,{class:"p-t-10",type:"info",onClick:r[4]||(r[4]=d=>x("login"))},{default:h(()=>[F("Log in")]),_:1})]),_:1},8,["model","rules","onKeyup"]))])])])}}});const Ee=te(me,[["__scopeId","data-v-e4b8e426"]]);export{Ee as default};
