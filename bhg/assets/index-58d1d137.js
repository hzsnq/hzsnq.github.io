import{a as k}from"./index-62d2fc31.js";/* empty css                 *//* empty css                 *//* empty css                   *//* empty css                  */import{i as K,_ as we}from"./index-c38978f2.js";import{d as H,o as J,r as _,D as ee,b as C,g as B,i as s,t as h,f as l,e,w as a,k as f,a0 as te,F as z,h as ne,c as M,J as O,E as oe,Q as se,N as ie,O as be,a1 as re,a2 as de,H as he,_ as Q,ak as Ee,al as ye,v as ce,x as ue,a4 as le,T as q,W as Ae,X as Ce,a7 as Ie,a8 as Ve,j as Pe,l as Ue,V as xe,a9 as ke,$ as Se,Y as De}from"./index-53be2c6b.js";/* empty css                     */import{P as me}from"./index-e099722b.js";import{i as $e}from"./validate-add6ff74.js";/* empty css                             */import{u as Re}from"./AppMain.vue_vue_type_style_index_0_scoped_41d4e859_lang-05b22a52.js";import"./useUser-a1bf5fc0.js";const X=Symbol("admin"),Te={class:"pop-top"},Fe={class:"title"},Ne={class:"form"},qe=H({__name:"CreateOrEditAdmin",setup(b){const{aId:v}=K(X),{func:c}=K(me);J(()=>{I(),v.value&&S()});const E=_([]),g=_(),d=ee({adminUserEmail:"",roleId:null,password:"asdf1234",password2:"asdf1234"}),o=ee({adminUserEmail:[{required:!0,message:"Please input Email",trigger:"blur"},{validator:(r,t,n)=>{t===""?n(new Error("Please input Email")):$e(t)?n():n(new Error("Email format is incorrect!"))},trigger:"blur"}],roleId:[{required:!0,message:"Please select Role",trigger:"change"}],password:[{required:!0,message:"Please input Password",trigger:"blur"},{min:8,max:16,message:"Length should be 8 to 16",trigger:"blur"}],password2:[{required:!0,message:"Please input Password",trigger:"blur"},{min:8,max:16,message:"Length should be 8 to 16",trigger:"blur"},{validator:(r,t,n)=>{t===""?n(new Error("Please input the Password again")):t!==d.password?n(new Error("Two inputs don't match!")):n()},trigger:"blur"}]}),y=async r=>{r&&await r.validate((t,n)=>{t?(console.log("submit!"),v.value?V():x()):(O.error("Please enter correct content!"),console.log("error submit!",n))})};async function I(){let r={};const[t,n]=await k.queryRoles(r);!t&&n&&(E.value=(n==null?void 0:n.data)||[])}async function x(){let r=d;const[t,n]=await k.createAdminUser(r);!t&&n&&n.success&&(O.success("Created successfully"),setTimeout(()=>{c()},1e3))}async function V(){let r={...d,id:v.value};const[t,n]=await k.editAdmin(r);!t&&n&&n.success&&(O.success("Edit successfully"),setTimeout(()=>{c()},1e3))}async function S(){var D,P;let r={id:v.value};const[t,n]=await k.queryAdminByIdWhenEdit(r);!t&&n&&(d.adminUserEmail=((D=n.data)==null?void 0:D.email)||"",d.roleId=Number((P=n.data)==null?void 0:P.roleId)||null)}return(r,t)=>{const n=oe,D=se,P=ie,$=be,W=re,j=de,Y=he;return C(),B(z,null,[s("div",Te,[s("div",Fe,h(l(v)?"Edit Admin User":"Create Admin User"),1),s("div",null,[e(D,{type:"primary",color:"#4E9F1C",onClick:t[0]||(t[0]=w=>y(l(g)))},{default:a(()=>[f(h(l(v)?"Edit Admin User":"New Admin User")+" ",1),e(n,null,{default:a(()=>[e(l(te))]),_:1})]),_:1})])]),s("div",Ne,[e(Y,{ref_key:"ruleFormRef",ref:g,model:l(d),rules:l(o),"label-width":"200px","status-icon":""},{default:a(()=>[e($,{label:"Email",prop:"adminUserEmail"},{default:a(()=>[e(P,{modelValue:l(d).adminUserEmail,"onUpdate:modelValue":t[1]||(t[1]=w=>l(d).adminUserEmail=w)},null,8,["modelValue"])]),_:1}),e($,{label:"Role",prop:"roleId"},{default:a(()=>[e(j,{modelValue:l(d).roleId,"onUpdate:modelValue":t[2]||(t[2]=w=>l(d).roleId=w),placeholder:"Select Role"},{default:a(()=>[(C(!0),B(z,null,ne(l(E),(w,p)=>(C(),M(W,{label:w.roleName,value:w.id,key:p},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e($,{label:"Password",prop:"password"},{default:a(()=>[e(P,{modelValue:l(d).password,"onUpdate:modelValue":t[3]||(t[3]=w=>l(d).password=w),type:"password",placeholder:"Please input password","show-password":""},null,8,["modelValue"])]),_:1}),e($,{label:"Password confirmation",prop:"password2"},{default:a(()=>[e(P,{modelValue:l(d).password2,"onUpdate:modelValue":t[4]||(t[4]=w=>l(d).password2=w),type:"password",placeholder:"Please input password","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])],64)}}});const ae=Q(qe,[["__scopeId","data-v-11c4a30d"]]),Be=b=>(ce("data-v-914076a1"),b=b(),ue(),b),ze=Be(()=>s("div",{class:"pop-top"},[s("div",{class:"title"},"View Admin User"),s("div")],-1)),Le={class:"form"},Me=H({__name:"ViewAdmin",setup(b){const{aId:v}=K(X),c=_({});J(()=>{E()});async function E(){let g={id:v.value};const[d,u]=await k.queryAdminById(g);!d&&u&&(c.value=(u==null?void 0:u.data)||{})}return(g,d)=>{const u=Ee,F=ye;return C(),B(z,null,[ze,s("div",Le,[e(F,{column:1,border:""},{default:a(()=>[e(u,{label:"Email","label-align":"center",align:"center"},{default:a(()=>{var o;return[f(h((o=l(c))==null?void 0:o.email),1)]}),_:1}),e(u,{label:"ID","label-align":"center",align:"center"},{default:a(()=>{var o;return[f(h((o=l(c))==null?void 0:o.id),1)]}),_:1}),e(u,{label:"Reset PWD Token","label-align":"center",align:"center"},{default:a(()=>{var o;return[f(h(((o=l(c))==null?void 0:o.resetPwdToken)||"EMPTY"),1)]}),_:1}),e(u,{label:"Reset PWD Send at","label-align":"center",align:"center"},{default:a(()=>{var o;return[f(h(((o=l(c))==null?void 0:o.resetPwdSendAt)||"EMPTY"),1)]}),_:1}),e(u,{label:"Create at","label-align":"center",align:"center"},{default:a(()=>{var o;return[f(h((o=l(c))==null?void 0:o.createAt),1)]}),_:1}),e(u,{label:"Update at","label-align":"center",align:"center"},{default:a(()=>{var o;return[f(h((o=l(c))==null?void 0:o.updateAt),1)]}),_:1}),e(u,{label:"Role","label-align":"center",align:"center"},{default:a(()=>{var o;return[f(h((o=l(c))==null?void 0:o.role),1)]}),_:1})]),_:1})])],64)}}});const Oe=Q(Me,[["__scopeId","data-v-914076a1"]]),G=b=>(ce("data-v-c2f4113b"),b=b(),ue(),b),We={class:"admin"},je=G(()=>s("div",{class:"title"},"Admin List",-1)),Ye={class:"tool-box"},Ke={class:"flex"},He={class:"table"},Je={class:"table-name"},Qe={class:"pointer"},Xe={class:"action"},Ge=["onClick"],Ze=["onClick"],el=G(()=>s("span",null,"Are you sure to delete this?",-1)),ll={class:"dialog-footer"},al={class:"pagination"},tl=G(()=>s("div",null,null,-1)),nl=H({__name:"index",setup(b){const{setBreadcrumbList:v}=Re(),c=_(),E=[{name:"add",component:ae},{name:"view",component:Oe},{name:"edit",component:ae}],g=_(null),d=[{value:0,label:"Contains"},{value:1,label:"Equals"},{value:2,label:"Starts with"},{value:3,label:"Ends with"}],u=_([]),F=_(0),o=_(10),y=_(1),I=_(null),x=_(""),V=_(!1),S=_(null);J(()=>{r()});async function r(){var L,U;g.value=null;let p={pageSize:o.value,pageNum:y.value},i={filterType:I.value,adminUserEmail:x.value};const[R,A]=await k.queryAdminUsers(i,p);!R&&A?(console.log(A.data),F.value=((L=A.data)==null?void 0:L.total)||0,u.value=((U=A.data)==null?void 0:U.list)||[]):console.log(R)}const t=()=>{v([{name:"Create Admin User"}]),g.value=E.findIndex(p=>p.name==="add"),S.value=null,c.value.handleIsShow()},n=p=>{v([{name:"Edit Admin User"}]),g.value=E.findIndex(i=>i.name==="edit"),S.value=p.id,c.value.handleIsShow()},D=p=>{v([{name:"View Admin User"}]),g.value=E.findIndex(i=>i.name==="view"),S.value=p.id,c.value.handleIsShow()},P=()=>{V.value=!0},$=async p=>{const i={id:p.id},[R,A]=await k.delAdmin(i);!R&&A&&(A.data&&O.success("delete success"),V.value=!1,r())},W=()=>{console.log(I.value),y.value=1,r()},j=p=>{y.value=p,r()},Y=()=>{I.value=null,x.value="",y.value=1,r()};return le(me,{func:()=>{c.value&&c.value.handleIsShow()}}),le(X,{aId:S}),(p,i)=>{const R=re,A=de,L=ie,U=se,Z=oe,N=xe,pe=ke,_e=Se,fe=Ae,ve=De,ge=Ce;return C(),B(z,null,[s("div",We,[je,s("div",Ye,[s("div",Ke,[e(A,{class:"select",modelValue:l(I),"onUpdate:modelValue":i[0]||(i[0]=m=>q(I)?I.value=m:null),clearable:"",placeholder:"Filter by"},{default:a(()=>[(C(),B(z,null,ne(d,m=>e(R,{key:m.value,label:m.label,value:m.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),e(L,{modelValue:l(x),"onUpdate:modelValue":i[1]||(i[1]=m=>q(x)?x.value=m:null),class:"m-lr-20",placeholder:"Search","prefix-icon":l(Ie),clearable:""},null,8,["modelValue","prefix-icon"]),e(U,{class:"text-white",type:"primary",color:"#BE9670",onClick:W},{default:a(()=>[f(" Search ")]),_:1}),e(U,{class:"text-828282",type:"primary",color:"#E8E8E8",onClick:Y},{default:a(()=>[f(" Clear ")]),_:1})]),s("div",null,[e(U,{type:"primary",color:"#4E9F1C",onClick:t},{default:a(()=>[f(" New Admin User "),e(Z,null,{default:a(()=>[e(l(te))]),_:1})]),_:1})])]),s("div",He,[l(u).length>0?(C(),M(fe,{key:0,data:l(u),height:"600","row-style":{height:"80px"}},{default:a(()=>[e(N,{prop:"id",label:"Admin ID",align:"center"},{default:a(m=>[s("div",Je,[s("span",null,h(m.row.id),1)])]),_:1}),e(N,{prop:"email",label:"Email",align:"left"}),e(N,{prop:"createAt",label:"Create at",align:"left"}),e(N,{prop:"role",label:"Role"}),e(N,{prop:"",label:"Action",align:"center"},{default:a(m=>[s("div",Qe,[e(_e,{placement:"bottom",width:170,trigger:"hover"},{reference:a(()=>[e(Z,{size:30,color:"#969696"},{default:a(()=>[e(l(Ve))]),_:1})]),default:a(()=>[s("div",Xe,[s("div",{class:"item",onClick:T=>D(m.row)},"View",8,Ge),s("div",{class:"item",onClick:T=>n(m.row)},"Edit",8,Ze),s("div",{class:"item",onClick:i[2]||(i[2]=T=>P())},"Delete"),e(pe,{modelValue:l(V),"onUpdate:modelValue":i[4]||(i[4]=T=>q(V)?V.value=T:null),title:"Message",width:"30%","align-center":""},{footer:a(()=>[s("span",ll,[e(U,{onClick:i[3]||(i[3]=T=>V.value=!1)},{default:a(()=>[f("Cancel")]),_:1}),e(U,{type:"primary",onClick:T=>$(m.row)},{default:a(()=>[f(" Confirm ")]),_:2},1032,["onClick"])])]),default:a(()=>[el]),_:2},1032,["modelValue"])])]),_:2},1024)])]),_:1})]),_:1},8,["data"])):(C(),M(ve,{key:1,"image-size":200}))]),s("div",al,[tl,e(ge,{background:"",layout:"total,consists of sizes, prev, pager, next, jumper, ->, slot",total:l(F),"page-size":l(o),"onUpdate:pageSize":i[5]||(i[5]=m=>q(o)?o.value=m:null),"current-page":l(y),"onUpdate:currentPage":i[6]||(i[6]=m=>q(y)?y.value=m:null),onCurrentChange:j},null,8,["total","page-size","current-page"])])]),e(l(we),{ref_key:"rightPanel",ref:c,onBackFn:r},{content:a(()=>[l(g)!==null?(C(),M(Pe(E[l(g)].component),{key:0})):Ue("",!0)]),_:1},512)],64)}}});const wl=Q(nl,[["__scopeId","data-v-c2f4113b"]]);export{wl as default};
