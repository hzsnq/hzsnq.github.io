import{a as V}from"./index-06066bd7.js";/* empty css                     *//* empty css                    *//* empty css                 *//* empty css                 *//* empty css                   */import{d as G,r as L,D as k,o as M,b as p,g as c,i as b,t as N,f as a,e as l,w as o,k as P,a0 as $,F as I,h as S,c as j,ap as J,aq as Q,T as W,J as C,E as X,Q as Y,N as Z,O as ee,a1 as te,a2 as le,ab as ae,H as se,_ as ie}from"./index-1ae8a691.js";import{i as U}from"./index-68a634a2.js";import{P as oe}from"./index-e099722b.js";import{E as ne}from"./CreatePurchase.vue_vue_type_style_index_0_scoped_0b5a1580_lang-dd48f447.js";const re={class:"pop-top"},ue={class:"title"},de={class:"form"},me={class:"email-list"},pe={key:0,class:"flex"},ce={key:1,class:"flex"},ye=G({__name:"CreateOrEditEntity",setup(fe){const{eId:y,clientInfo:v,entityInfo:u}=U(ne),{func:T}=U(oe),E=L([]),f=L([]),F=L(),e=k({addressLine:"",bhgId:"",emailList:[],entityName:"",suburb:"",state:"",postcode:"",applicationFormSigned:"",entityType:""}),q=k({entityName:[{required:!0,message:"Please input Entity Name",trigger:"blur"}],bhgId:[{required:!0,message:"Please input BHG ID",trigger:"blur"}],suburb:[{required:!0,message:"Please input Suburb",trigger:"blur"}],addressLine:[{required:!0,message:"Please input Address line",trigger:"blur"}],state:[{required:!0,message:"Please input State",trigger:"blur"}],entityType:[{required:!0,message:"Please select Investor Type",trigger:"change"}],postcode:[{required:!0,message:"Please input Postcode",trigger:"blur"}],emailList:[{type:"array",required:!0,message:"Please input email",trigger:"blur"}]});M(async()=>{const i=[{email:v.value.email}];e.emailList=i,await h(),y.value&&D()});const w=async i=>{i&&await i.validate((t,n)=>{t?(console.log("submit!"),e.applicationFormSigned=f.value.length>0?f.value[0].raw:"",y.value?B():x()):(C.error("Please enter correct content!"),console.log("error submit!",n))})};async function h(){let i={type:"investment_entity_type"};const[t,n]=await V.queryDictionary(i);!t&&n&&(E.value=(n==null?void 0:n.data)||[])}async function x(){let i={...e,clientId:v.value.id};const t=e.emailList.map(r=>r.email);i.emailList=t;const[n,m]=await V.createEntity(i);!n&&m&&m.success&&(C.success("Created successfully"),setTimeout(()=>{T("entity")},1e3))}async function B(){let i={...e,id:y.value,clientId:v.value.id};const t=e.emailList.map(r=>r.email);i.emailList=t;const[n,m]=await V.editEntity(i);!n&&m&&m.success&&(C.success("Edit successfully"),setTimeout(()=>{T()},1e3))}function D(){if(console.log(u.value),u.value.emailList.length>0){const i=u.value.emailList.map(t=>({email:t}));e.emailList=i}if(u.value.entityType){const i=E.value.find(t=>t.code===u.value.entityType);e.entityType=i.value||""}e.addressLine=u.value.addressLine,e.bhgId=u.value.bhgId,e.entityName=u.value.entityName,e.suburb=u.value.suburb,e.state=u.value.state,e.postcode=u.value.postcode}const A=()=>{e.emailList.push({email:""})},O=i=>{e.emailList.splice(i,1)};return(i,t)=>{const n=X,m=Y,r=Z,d=ee,H=te,K=le,R=ae,z=se;return p(),c(I,null,[b("div",re,[b("div",ue,N(a(y)?"Edit Entity":"Create Entity"),1),b("div",null,[l(m,{type:"primary",color:"#4E9F1C",onClick:t[0]||(t[0]=s=>w(a(F)))},{default:o(()=>[P(N(a(y)?"Edit Entity":"Create Entity")+" ",1),l(n,null,{default:o(()=>[l(a($))]),_:1})]),_:1})])]),b("div",de,[l(z,{ref_key:"ruleFormRef",ref:F,model:a(e),rules:a(q),"label-width":"200px","status-icon":""},{default:o(()=>[l(d,{label:"BHG ID",prop:"bhgId"},{default:o(()=>[l(r,{modelValue:a(e).bhgId,"onUpdate:modelValue":t[1]||(t[1]=s=>a(e).bhgId=s)},null,8,["modelValue"])]),_:1}),l(d,{label:"Investor Type",prop:"entityType"},{default:o(()=>[l(K,{modelValue:a(e).entityType,"onUpdate:modelValue":t[2]||(t[2]=s=>a(e).entityType=s),placeholder:"Select Investor Type"},{default:o(()=>[(p(!0),c(I,null,S(a(E),(s,_)=>(p(),j(H,{label:s.code,value:s.value,key:_},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"Entity Name",prop:"entityName"},{default:o(()=>[l(r,{modelValue:a(e).entityName,"onUpdate:modelValue":t[3]||(t[3]=s=>a(e).entityName=s)},null,8,["modelValue"])]),_:1}),l(d,{label:"Email",prop:"emailList"},{default:o(()=>[b("div",me,[(p(!0),c(I,null,S(a(e).emailList,(s,_)=>(p(),c("div",{key:_},[_===0?(p(),c("div",pe,[l(r,{modelValue:s.email,"onUpdate:modelValue":g=>s.email=g},null,8,["modelValue","onUpdate:modelValue"]),l(n,{class:"pointer",color:"#4E9F1C",size:"20",onClick:A},{default:o(()=>[l(a(J))]),_:1})])):(p(),c("div",ce,[l(r,{modelValue:s.email,"onUpdate:modelValue":g=>s.email=g},null,8,["modelValue","onUpdate:modelValue"]),l(n,{class:"pointer",color:"#E92C2C",size:"20",onClick:g=>O(_)},{default:o(()=>[l(a(Q))]),_:2},1032,["onClick"])]))]))),128))])]),_:1}),l(d,{label:"Address line",prop:"addressLine"},{default:o(()=>[l(r,{modelValue:a(e).addressLine,"onUpdate:modelValue":t[4]||(t[4]=s=>a(e).addressLine=s)},null,8,["modelValue"])]),_:1}),l(d,{label:"Suburb",prop:"suburb"},{default:o(()=>[l(r,{modelValue:a(e).suburb,"onUpdate:modelValue":t[5]||(t[5]=s=>a(e).suburb=s)},null,8,["modelValue"])]),_:1}),l(d,{label:"State",prop:"state"},{default:o(()=>[l(r,{modelValue:a(e).state,"onUpdate:modelValue":t[6]||(t[6]=s=>a(e).state=s)},null,8,["modelValue"])]),_:1}),l(d,{label:"Postcode",prop:"postcode"},{default:o(()=>[l(r,{modelValue:a(e).postcode,"onUpdate:modelValue":t[7]||(t[7]=s=>a(e).postcode=s)},null,8,["modelValue"])]),_:1}),l(d,{label:"Application form signed",prop:"applicationFormSigned"},{default:o(()=>[l(R,{"file-list":a(f),"onUpdate:fileList":t[8]||(t[8]=s=>W(f)?f.value=s:null),"auto-upload":!1,limit:1,"list-type":"text"},{trigger:o(()=>[l(m,{type:"primary"},{default:o(()=>[P("Choose file")]),_:1})]),_:1},8,["file-list"])]),_:1})]),_:1},8,["model","rules"])])],64)}}}),Fe=ie(ye,[["__scopeId","data-v-ccf9cde9"]]),ke=Symbol("investment");export{Fe as C,ke as I};
