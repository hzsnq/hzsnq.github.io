import{a as g}from"./index-1beab65c.js";/* empty css                     *//* empty css                    *//* empty css                 *//* empty css                  *//* empty css                   */import"./useUser-7f9c8acd.js";import{d as K,r as L,D as k,o as M,b as p,g as c,i as v,t as N,f as a,e as l,w as s,k as U,$ as j,F as I,h as w,c as G,aq as J,ar as Q,T as W,J as C,E as X,P as Y,N as Z,O as ee,a1 as te,a2 as le,ai as ae,H as oe,_ as ie}from"./index-298568e1.js";import{i as S}from"./index-38ed8943.js";import{P as se}from"./index-e099722b.js";import{E as ne}from"./CreatOrEditEntity.vue_vue_type_style_index_0_scoped_3ce8e608_lang-39aa2ba5.js";const ue={class:"pop-top"},de={class:"title"},re={class:"form"},me={class:"email-list"},pe={key:0,class:"flex"},ce={key:1,class:"flex"},ye=K({__name:"CreatOrEditEntity",setup(fe){const{eId:y,clientInfo:b,entityInfo:d}=S(ne),{func:T}=S(se),V=L([]),f=L([]),F=L(),e=k({addressLine:"",bhgId:"",emailList:[],entityName:"",suburb:"",state:"",postcode:"",applicationFormSigned:"",entityType:""}),h=k({entityName:[{required:!0,message:"Please input Entity Name",trigger:"blur"}]});M(async()=>{const i=[{email:b.value.email}];e.emailList=i,await B(),y.value&&q()});const x=async i=>{i&&await i.validate((t,n)=>{t?(console.log("submit!"),e.applicationFormSigned=f.value.length>0?f.value[0].raw:"",y.value?D():P()):(C.error("Please enter correct content!"),console.log("error submit!",n))})};async function B(){let i={type:"investment_entity_type"};const[t,n]=await g.queryDictionary(i);!t&&n&&(V.value=(n==null?void 0:n.data)||[])}async function P(){let i={...e,clientId:b.value.id};const t=e.emailList.map(u=>u.email);i.emailList=t;const[n,m]=await g.createEntity(i);!n&&m&&m.success&&(C.success("Created successfully"),setTimeout(()=>{T("entity")},1e3))}async function D(){let i={...e,id:y.value,clientId:b.value.id};const t=e.emailList.map(u=>u.email);i.emailList=t;const[n,m]=await g.editEntity(i);!n&&m&&m.success&&(C.success("Edit successfully"),setTimeout(()=>{T()},1e3))}function q(){if(console.log(d.value),d.value.emailList.length>0){const i=d.value.emailList.map(t=>({email:t}));e.emailList=i}if(d.value.entityType){const i=V.value.find(t=>t.code===d.value.entityType);e.entityType=i.value||""}e.addressLine=d.value.addressLine,e.bhgId=d.value.bhgId,e.entityName=d.value.entityName,e.suburb=d.value.suburb,e.state=d.value.state,e.postcode=d.value.postcode}const A=()=>{e.emailList.push({email:""})},O=i=>{e.emailList.splice(i,1)};return(i,t)=>{const n=X,m=Y,u=Z,r=ee,R=te,$=le,z=ae,H=oe;return p(),c(I,null,[v("div",ue,[v("div",de,N(a(y)?"Edit Entity":"Create Entity"),1),v("div",null,[l(m,{type:"primary",color:"#4E9F1C",onClick:t[0]||(t[0]=o=>x(a(F)))},{default:s(()=>[U(N(a(y)?"Edit Entity":"Create Entity")+" ",1),l(n,null,{default:s(()=>[l(a(j))]),_:1})]),_:1})])]),v("div",re,[l(H,{ref_key:"ruleFormRef",ref:F,model:a(e),rules:a(h),"label-width":"200px","status-icon":""},{default:s(()=>[l(r,{label:"BHG ID",prop:"bhgId"},{default:s(()=>[l(u,{modelValue:a(e).bhgId,"onUpdate:modelValue":t[1]||(t[1]=o=>a(e).bhgId=o)},null,8,["modelValue"])]),_:1}),l(r,{label:"Investor Type",prop:"entityType"},{default:s(()=>[l($,{modelValue:a(e).entityType,"onUpdate:modelValue":t[2]||(t[2]=o=>a(e).entityType=o),placeholder:"Select Investor Type"},{default:s(()=>[(p(!0),c(I,null,w(a(V),(o,_)=>(p(),G(R,{label:o.code,value:o.value,key:_},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"Entity Name",prop:"entityName"},{default:s(()=>[l(u,{modelValue:a(e).entityName,"onUpdate:modelValue":t[3]||(t[3]=o=>a(e).entityName=o)},null,8,["modelValue"])]),_:1}),l(r,{label:"Email",prop:"emailList"},{default:s(()=>[v("div",me,[(p(!0),c(I,null,w(a(e).emailList,(o,_)=>(p(),c("div",{key:_},[_===0?(p(),c("div",pe,[l(u,{modelValue:o.email,"onUpdate:modelValue":E=>o.email=E},null,8,["modelValue","onUpdate:modelValue"]),l(n,{class:"pointer",color:"#4E9F1C",size:"20",onClick:A},{default:s(()=>[l(a(J))]),_:1})])):(p(),c("div",ce,[l(u,{modelValue:o.email,"onUpdate:modelValue":E=>o.email=E},null,8,["modelValue","onUpdate:modelValue"]),l(n,{class:"pointer",color:"#E92C2C",size:"20",onClick:E=>O(_)},{default:s(()=>[l(a(Q))]),_:2},1032,["onClick"])]))]))),128))])]),_:1}),l(r,{label:"Address line",prop:"addressLine"},{default:s(()=>[l(u,{modelValue:a(e).addressLine,"onUpdate:modelValue":t[4]||(t[4]=o=>a(e).addressLine=o)},null,8,["modelValue"])]),_:1}),l(r,{label:"Suburb",prop:"suburb"},{default:s(()=>[l(u,{modelValue:a(e).suburb,"onUpdate:modelValue":t[5]||(t[5]=o=>a(e).suburb=o)},null,8,["modelValue"])]),_:1}),l(r,{label:"State",prop:"state"},{default:s(()=>[l(u,{modelValue:a(e).state,"onUpdate:modelValue":t[6]||(t[6]=o=>a(e).state=o)},null,8,["modelValue"])]),_:1}),l(r,{label:"Postcode",prop:"postcode"},{default:s(()=>[l(u,{modelValue:a(e).postcode,"onUpdate:modelValue":t[7]||(t[7]=o=>a(e).postcode=o)},null,8,["modelValue"])]),_:1}),l(r,{label:"Application form signed",prop:"applicationFormSigned"},{default:s(()=>[l(z,{"file-list":a(f),"onUpdate:fileList":t[8]||(t[8]=o=>W(f)?f.value=o:null),"auto-upload":!1,limit:1,"list-type":"text"},{trigger:s(()=>[l(m,{type:"primary"},{default:s(()=>[U("Choose file")]),_:1})]),_:1},8,["file-list"])]),_:1})]),_:1},8,["model","rules"])])],64)}}}),ke=ie(ye,[["__scopeId","data-v-3ce8e608"]]);export{ke as C};
